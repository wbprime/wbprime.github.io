<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Learning Java Concurrency - CyclicBarrier - Elvis Wang</title>
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="wangboâ€™s home &amp; blog"/>

    <meta property="og:title" content="
    wangboâ€™s blog -&nbsp;Learning Java Concurrency - CyclicBarrier" />
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-03-30-learning-java-concurrency-cyclicbarrier&#x2F;"/>
    <meta property="og:description" content="&lt;p&gt;CyclicBarrierï¼Œæ­£å¦‚åŒåå­—é‡Œé¢è¡¨è¾¾å‡ºæ¥çš„ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å¾ªç¯ä½¿ç”¨çš„å±éšœã€‚ä¸CountDownLatchç±»ä¼¼ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¡¨è¾¾ç­‰å¾…æŸä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚å¤§å®¶éƒ½åˆ°é½äº†ï¼Œé‚£ä¹ˆå¼€å§‹å¼€ä¼šå§ã€‚ä¸CountDownLatchä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ä»¥å¤šæ¬¡ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç­‰å¾…å¤šä¸ªçŠ¶æ€ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å¥½åƒä¸è¿‡æ —å­ã€‚æ¯”å¦‚å“ˆåˆ©æ³¢ç‰¹çš„ä¸‰å¼ºäº‰éœ¸èµ›ï¼Œè¦ä¸€é¡¹ä¸€é¡¹ä»»åŠ¡åœ°å®Œæˆï¼Œå¤§å®¶éƒ½ç»“æŸäº†â€¦"/>
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;style.css">
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;color&#x2F;red.css">
<link rel="shortcut icon" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;favicon.ico" type="image/x-icon" /></head>
    <body>
        <div class="container full">
<header class="header">
    <div class="header__inner">
        <div class="header__logo">
            <a href="&#x2F;">
    <div class="logo">
        WB Prime
    </div>
</a>
        </div>
        <div class="menu-trigger">menu</div>
    </div>
    
    <nav class="menu">
        <ul class="menu__inner menu__inner--desktop">
            
            
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
                    </li>
                
            </ul>

        <ul class="menu__inner menu__inner--mobile">
            
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
        </li>
        </ul>
    </nav>

    </header>
<div class="content"><div class="post">
        <h1 class="post-title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-03-30-learning-java-concurrency-cyclicbarrier&#x2F;">Learning Java Concurrency - CyclicBarrier</a>
        </h1>
        
    <div class="post-meta">
        <span class="post-date">2016.03.30
                </span>

        <span class="post-author"></span>

        

    
    :: {<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories&#x2F;learning-java-concurrency&#x2F;">Learning Java Concurrency</a>} 

            
    ::
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;java&#x2F;">java</a>
        
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;concurrency&#x2F;">concurrency</a>
        
    
            
        
    </div>



        

        <div class="post-content">
            <p>CyclicBarrierï¼Œæ­£å¦‚åŒåå­—é‡Œé¢è¡¨è¾¾å‡ºæ¥çš„ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å¾ªç¯ä½¿ç”¨çš„å±éšœã€‚ä¸CountDownLatchç±»ä¼¼ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¡¨è¾¾ç­‰å¾…æŸä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚å¤§å®¶éƒ½åˆ°é½äº†ï¼Œé‚£ä¹ˆå¼€å§‹å¼€ä¼šå§ã€‚ä¸CountDownLatchä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ä»¥å¤šæ¬¡ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç­‰å¾…å¤šä¸ªçŠ¶æ€ã€‚</p>
<p>å¥½åƒä¸è¿‡æ —å­ã€‚æ¯”å¦‚å“ˆåˆ©æ³¢ç‰¹çš„ä¸‰å¼ºäº‰éœ¸èµ›ï¼Œè¦ä¸€é¡¹ä¸€é¡¹ä»»åŠ¡åœ°å®Œæˆï¼Œå¤§å®¶éƒ½ç»“æŸäº†ï¼ˆä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰ï¼Œæ‰å¼€å§‹è®¡åˆ’ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ç¬¬ä¸€ä¸ªæ˜¯å»æŒ‘æˆ˜é¾™ï¼›ç„¶åæ˜¯åˆ°æµ·é‡Œé¢æŒ‘æˆ˜äººé±¼ç¾¤ï¼›æœ€åæ˜¯æŒ‘æˆ˜ä¼åœ°é­”ã€‚æ¯ä¸€ä¸ªä»»åŠ¡æ€»æ˜¯è¦ç­‰å¤§å®¶éƒ½å®Œæˆäº†æ‰å¼€å§‹ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªæ —å­ã€‚å¤§å®¶ä¸€èµ·å»é¢è¯•ï¼Œæœ‰çš„å…¬å¸ä¸ºäº†çœäº‹ï¼Œç­‰å‡‘é½äº†ä¸€æ³¢äººæ‰å¼€å§‹èµ°æµç¨‹ã€‚HRé¢†ç€å¤§å®¶ä¸€èµ·å…ˆç¬”è¯•ï¼Œç„¶åå®‰æ’åˆé¢å®˜ï¼Œç„¶åå®‰æ’å¤è¯•å®˜ã€‚æ¯ä¸€å…³åˆ·æ‰ä¸€æ³¢äººï¼Œä½†æ˜¯åªæœ‰å¤§å®¶éƒ½ç»“æŸäº†æ‰è¿›è¡Œä¸‹ä¸€è½®ã€‚åˆ«é—®æˆ‘å“ªé‡Œæœ‰è¿™æ ·çš„æ‹›è˜éƒ¨é—¨ï¼Œäººå®¶å¼€å¿ƒå°±å¥½ã€‚</p>
<p><a name="continue-reading"></a></p>
<h1 id="cyclicbarrier-de-jian-dan-shi-yong"><a class="zola-anchor" href="#cyclicbarrier-de-jian-dan-shi-yong" aria-label="Anchor link for: cyclicbarrier-de-jian-dan-shi-yong">ğŸ”—</a>
CyclicBarrier çš„ç®€å•ä½¿ç”¨</h1>
<p>é¦–å…ˆï¼Œéœ€è¦åˆ¤æ–­æœ‰å“ªäº›å…³å¡ï¼Œè®¾è®¡å¥½é€šå…³æ¡ä»¶ã€‚</p>
<p>ç„¶åï¼Œåˆ›å»ºé—¯å…³çš„çº¿ç¨‹ï¼Œå„è‡ªåƒå¥½å–å¥½ï¼Œå‡†å¤‡é—¯å…³ã€‚</p>
<p>ç„¶åï¼Œæ¯è¿‡ä¸€å…³ï¼Œå¯ä»¥æœ‰çœ‹å®ˆçš„çº¿ç¨‹å‡ºæ¥å¼•å¯¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä»»åŠ¡ã€‚</p>
<p>ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹äº†ã€‚</p>
<h1 id="cyclicbarrier-de-api"><a class="zola-anchor" href="#cyclicbarrier-de-api" aria-label="Anchor link for: cyclicbarrier-de-api">ğŸ”—</a>
CyclicBarrier çš„API</h1>
<p>CyclicBarrieræ˜¯æ¥åšå¤šçº¿ç¨‹åŒæ­¥çš„ï¼Œé¦–å…ˆéœ€è¦ç¡®å®šæœ‰å¤šå°‘ä¸ªçº¿ç¨‹å‚ä¸åŒæ­¥ã€‚æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½éœ€è¦è°ƒç”¨await()è¡¨ç¤ºè‡ªå·±å·²ç»å°±ç»ªï¼›å½“æ‰€æœ‰çº¿ç¨‹éƒ½è°ƒç”¨äº†await()ä¹‹åï¼ŒCyclicBarrierè¾¾åˆ°äº†ç¬¬ä¸€ä¸ªå±éšœã€‚æ­¤æ—¶å¯ä»¥ç®€å•åœ°æ”¾è¡Œï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªä»»åŠ¡ï¼Œç”±æœ€åä¸€ä¸ªå°±ç»ªçš„çº¿ç¨‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ‰æ”¾è¡Œã€‚</p>
<ol>
<li>CyclicBarrier(int n)
æ„é€ ä¸€ä¸ªæœ‰nä¸ªçº¿ç¨‹å‚ä¸åŒæ­¥çš„åŒæ­¥å™¨ï¼Œé˜»å¡æ‰€æœ‰çº¿ç¨‹ç›´åˆ°é˜»å¡çš„çº¿ç¨‹ä¸ªæ•°å¤§äºç­‰äºnã€‚</li>
<li>CyclicBarrier(int n, Runnable action)
æ„é€ ä¸€ä¸ªæœ‰nä¸ªçº¿ç¨‹å‚ä¸åŒæ­¥çš„åŒæ­¥å™¨ï¼Œé˜»å¡æ‰€æœ‰çº¿ç¨‹ç›´åˆ°é˜»å¡çš„çº¿ç¨‹ä¸ªæ•°å¤§äºç­‰äºnã€‚æ¥è§¦é˜»å¡ä¹‹å‰ï¼Œç”±æœ€åä¸€ä¸ªè¾¾åˆ°çš„æ–°åŸæ‰§è¡Œactionã€‚</li>
<li>int await() throws InterruptedException, BrokenBarrierException
é˜»å¡è°ƒç”¨çº¿ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰nä¸ªçº¿ç¨‹éƒ½è°ƒç”¨äº†æœ¬æ–¹æ³•ã€‚æœ€åä¸€ä¸ªè°ƒç”¨æœ¬æ–¹æ³•çš„çº¿ç¨‹ï¼Œéœ€è¦å»æ‰§è¡Œè®¾ç½®çš„é˜»å¡ä»»åŠ¡ï¼Œå¦‚æœè®¾ç½®äº†çš„è¯ã€‚</li>
<li>int await(long timeout, TimeUnit unit) throws InterruptedException, BrokenBarrierException, TimeoutException
åŒä¸Šï¼ŒåŠ ä¸Šäº†è¶…æ—¶é™åˆ¶ã€‚è¿”å›å€¼è¡¨ç¤ºè¿˜æœ‰å¤šå°‘ä¸ªçº¿ç¨‹æœªå°±ç»ªï¼Œ0è¡¨ç¤ºè°ƒç”¨çº¿ç¨‹æ˜¯æœ€åä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li>int getParties()
è¿”å›æ„é€ å™¨ä¼ å…¥çš„nå€¼ã€‚</li>
<li>boolean isBroken()
æ˜¯å¦è¢«æŸåï¼ŒæŸååŸå› å¯èƒ½æ˜¯çº¿ç¨‹è¢«ä¸­æ–­æˆ–è€…è¶…æ—¶ï¼Œæˆ–è€…é˜»å¡actionå‘ç”Ÿå¼‚å¸¸ã€‚</li>
<li>void reset()
é‡ç½®åˆ°åˆå§‹åŒ–çŠ¶æ€ã€‚</li>
<li>int getNumberWaiting()
è¿”å›å½“å‰å·²ç»ç­‰å¾…çš„çº¿ç¨‹æ•°ã€‚</li>
</ol>
<p>CyclicBarrierå†…éƒ¨æ˜¯é€šè¿‡ä¸€ä¸ªReentrantLockå®ä¾‹æ¥è¿›è¡ŒåŒæ­¥çš„ï¼Œç”¨è¯¥å®ä¾‹çš„ä¸€ä¸ªConditionå®ä¾‹æ¥æ§åˆ¶æ˜¯å¦è¾¾åˆ°æ”¾è¡ŒçŠ¶æ€ã€‚</p>
<pre style="background-color:#282828;">
<span style="font-style:italic;color:#928374;">/** The lock for guarding barrier entry */
</span><span style="color:#fa5c4b;">private final </span><span style="color:#8ec07c;">ReentrantLock</span><span style="color:#fdf4c1aa;"> lock </span><span style="color:#fe8019;">= </span><span style="color:#fa5c4b;">new </span><span style="color:#8ec07c;">ReentrantLock</span><span style="color:#fdf4c1aa;">();
</span><span style="font-style:italic;color:#928374;">/** Condition to wait on until tripped */
</span><span style="color:#fa5c4b;">private final </span><span style="color:#8ec07c;">Condition</span><span style="color:#fdf4c1aa;"> trip </span><span style="color:#fe8019;">=</span><span style="color:#fdf4c1aa;"> lock.</span><span style="color:#fdf4c1;">newCondition()</span><span style="color:#fdf4c1aa;">;
</span></pre><h1 id="shi-li-dai-ma"><a class="zola-anchor" href="#shi-li-dai-ma" aria-label="Anchor link for: shi-li-dai-ma">ğŸ”—</a>
ç¤ºä¾‹ä»£ç </h1>
<pre style="background-color:#282828;">
<span style="color:#fa5c4b;">package </span><span style="color:#8ec07c;">me.wbprime.showcase.concurrent</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">com</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">google</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">common</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">collect</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">ImmutableList</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">org</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">joda</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">time</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">LocalDate</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Random</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">concurrent</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">BrokenBarrierException</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">concurrent</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">CyclicBarrier</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">concurrent</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">ExecutorService</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fa5c4b;">import </span><span style="color:#fabd2f;">java</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">util</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fabd2f;">concurrent</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Executors</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="font-style:italic;color:#928374;">/**
</span><span style="font-style:italic;color:#928374;"> </span><span style="font-style:italic;color:#928374;">* Class: CyclicBarrierCase
</span><span style="font-style:italic;color:#928374;"> </span><span style="font-style:italic;color:#928374;">* Date: 2016/03/30 13:35
</span><span style="font-style:italic;color:#928374;"> </span><span style="font-style:italic;color:#928374;">*/
</span><span style="color:#fa5c4b;">public final class </span><span style="color:#8ec07c;">CyclicBarrierCase </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">private static class </span><span style="color:#8ec07c;">Interviewee </span><span style="color:#fa5c4b;">implements </span><span style="color:#8ec07c;">Runnable </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">private </span><span style="color:#8ec07c;">CyclicBarrier </span><span style="color:#fdf4c1aa;">barrier;
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">private </span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">&gt;  jobs;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">Interviewee</span><span style="color:#fdf4c1aa;">(</span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">&gt; </span><span style="color:#fdf4c1;">dt</span><span style="color:#fdf4c1aa;">, </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">CyclicBarrier </span><span style="color:#fdf4c1;">b</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">barrier </span><span style="color:#fe8019;">=</span><span style="color:#fdf4c1aa;"> b;
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">jobs </span><span style="color:#fe8019;">=</span><span style="color:#fdf4c1aa;"> dt;
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">public void </span><span style="color:#8ec07c;">run</span><span style="color:#fdf4c1aa;">() {
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fa5c4b;">try </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">                </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;"> myName </span><span style="color:#fe8019;">= </span><span style="color:#8ec07c;">Thread</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">currentThread()</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">getName()</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">                </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">Random</span><span style="color:#fdf4c1aa;"> rnd </span><span style="color:#fe8019;">= </span><span style="color:#fa5c4b;">new </span><span style="color:#8ec07c;">Random</span><span style="color:#fdf4c1aa;">(</span><span style="color:#8ec07c;">System</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">currentTimeMillis()</span><span style="color:#fdf4c1aa;">);
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">                </span><span style="color:#fa5c4b;">for </span><span style="color:#fdf4c1aa;">(</span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;"> eachJob</span><span style="color:#fe8019;">:</span><span style="color:#fdf4c1aa;"> jobs) {
</span><span style="color:#fdf4c1aa;">                    </span><span style="color:#fdf4c1aa;">barrier.</span><span style="color:#fdf4c1;">await()</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">                    </span><span style="color:#8ec07c;">System</span><span style="color:#fdf4c1aa;">.out.</span><span style="color:#fdf4c1;">println(myName </span><span style="color:#fe8019;">+ </span><span style="color:#b8bb26;">&quot;: Start processing job: &quot; </span><span style="color:#fe8019;">+</span><span style="color:#fdf4c1;"> eachJob)</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">                    </span><span style="color:#fa5c4b;">final int</span><span style="color:#fdf4c1aa;"> sleepTime </span><span style="color:#fe8019;">=</span><span style="color:#fdf4c1aa;"> rnd.</span><span style="color:#fdf4c1;">nextInt(</span><span style="color:#d3869b;">1000</span><span style="color:#fdf4c1;">) </span><span style="color:#fe8019;">+ </span><span style="color:#d3869b;">1</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">                    </span><span style="color:#8ec07c;">Thread</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">sleep(sleepTime)</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">                    </span><span style="color:#8ec07c;">System</span><span style="color:#fdf4c1aa;">.out.</span><span style="color:#fdf4c1;">println(myName </span><span style="color:#fe8019;">+ </span><span style="color:#b8bb26;">&quot;: Finish processing job: &quot; </span><span style="color:#fe8019;">+</span><span style="color:#fdf4c1;"> eachJob)</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">                </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">} </span><span style="color:#fa5c4b;">catch </span><span style="color:#fdf4c1aa;">(</span><span style="color:#8ec07c;">InterruptedException </span><span style="color:#fdf4c1;">e</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">                </span><span style="font-style:italic;color:#928374;">// do nothing
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">} </span><span style="color:#fa5c4b;">catch </span><span style="color:#fdf4c1aa;">(</span><span style="color:#8ec07c;">BrokenBarrierException </span><span style="color:#fdf4c1;">e</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">                </span><span style="font-style:italic;color:#928374;">// do nothing
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">private static class </span><span style="color:#8ec07c;">HR </span><span style="color:#fa5c4b;">implements </span><span style="color:#8ec07c;">Runnable </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">HR</span><span style="color:#fdf4c1aa;">() {
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">public void </span><span style="color:#8ec07c;">run</span><span style="color:#fdf4c1aa;">() {
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#8ec07c;">System</span><span style="color:#fdf4c1aa;">.out.</span><span style="color:#fdf4c1;">println(</span><span style="color:#b8bb26;">&quot;Hello everyone, go on to next challenge&quot;</span><span style="color:#fdf4c1;">)</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">public static void </span><span style="color:#8ec07c;">main</span><span style="color:#fdf4c1aa;">(</span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">String</span><span style="color:#fa5c4b;">[] </span><span style="color:#fdf4c1;">args</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">final int</span><span style="color:#fdf4c1aa;"> memberCount </span><span style="color:#fe8019;">= </span><span style="color:#d3869b;">3</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">&gt; workflow </span><span style="color:#fe8019;">= </span><span style="color:#8ec07c;">ImmutableList</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">of(
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;Self introduction&quot;</span><span style="color:#fdf4c1;">,
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;Coding exam&quot;</span><span style="color:#fdf4c1;">,
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;Tech interview&quot;</span><span style="color:#fdf4c1;">,
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;Leader interview&quot;</span><span style="color:#fdf4c1;">,
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;HR interview&quot;</span><span style="color:#fdf4c1;">,
</span><span style="color:#fdf4c1;">            </span><span style="color:#b8bb26;">&quot;Offer&quot;
</span><span style="color:#fdf4c1;">        </span><span style="color:#fdf4c1;">)</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">CyclicBarrier</span><span style="color:#fdf4c1aa;"> barrier </span><span style="color:#fe8019;">= </span><span style="color:#fa5c4b;">new </span><span style="color:#8ec07c;">CyclicBarrier</span><span style="color:#fdf4c1aa;">(memberCount, </span><span style="color:#fa5c4b;">new </span><span style="color:#8ec07c;">HR</span><span style="color:#fdf4c1aa;">());
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">final </span><span style="color:#8ec07c;">ExecutorService</span><span style="color:#fdf4c1aa;"> executor </span><span style="color:#fe8019;">= </span><span style="color:#8ec07c;">Executors</span><span style="color:#fdf4c1aa;">.</span><span style="color:#fdf4c1;">newCachedThreadPool()</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fa5c4b;">for </span><span style="color:#fdf4c1aa;">(</span><span style="color:#fa5c4b;">int</span><span style="color:#fdf4c1aa;"> i </span><span style="color:#fe8019;">= </span><span style="color:#d3869b;">0</span><span style="color:#fdf4c1aa;">; i </span><span style="color:#fe8019;">&lt;</span><span style="color:#fdf4c1aa;"> memberCount; i </span><span style="color:#fe8019;">++</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">executor.</span><span style="color:#fdf4c1;">execute(</span><span style="color:#fa5c4b;">new </span><span style="color:#8ec07c;">Interviewee</span><span style="color:#fdf4c1;">(workflow, barrier))</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">executor.</span><span style="color:#fdf4c1;">shutdown()</span><span style="color:#fdf4c1aa;">;
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">}
</span></pre><h1 id="shi-li-dai-ma-shuo-ming"><a class="zola-anchor" href="#shi-li-dai-ma-shuo-ming" aria-label="Anchor link for: shi-li-dai-ma-shuo-ming">ğŸ”—</a>
ç¤ºä¾‹ä»£ç è¯´æ˜</h1>
<ol>
<li>
<p>æŸå…¬å¸å…¬å¼€æ‹›è˜ï¼Œä¸€å…±æœ‰3ä¸ªäººè¿‡æ¥é¢è¯•ï¼ŒHRè¿›è¡Œå®‰æ’ã€‚</p>
</li>
<li>
<p>Intervieweeç±»è¡¨å¾å‰æ¥é¢è¯•çš„äººï¼Œæ‰‹ä¸Šæœ‰ä¸€ä»½æ—¥ç¨‹è¡¨ï¼ˆjobsï¼‰ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡éƒ½éœ€è¦HRé¢†ç€æ‰€æœ‰äººä¸€èµ·å¼€å§‹ã€‚</p>
</li>
<li>
<p>HRç±»è¡¨å¾åè°ƒçš„äººåŠ›èµ„æºï¼Œæ¯æ¬¡å‡†å¤‡ä¸‹ä¸€å…³æ—¶ï¼Œå¯ä»¥ç»™å¤§å®¶è§£é‡Šç–‘é—®ï¼ŒåŠ æ²¹æ‰“æ°”ã€‚</p>
</li>
<li>
<p>mainå‡½æ•°é‡Œé¢ï¼Œåˆ›å»ºæ—¥ç¨‹è¡¨ï¼Œåˆ›å»ºCyclicBarrierå®ä¾‹ï¼Œåˆ›å»ºHRå’Œåº”è¯•è€…ï¼Œç„¶åå¤§å®¶å¼€å§‹é¢è¯•ï¼Œä»è‡ªæˆ‘ä»‹ç»å¼€å§‹å§ã€‚</p>
</li>
</ol>
<h1 id="dai-ma-xia-zai"><a class="zola-anchor" href="#dai-ma-xia-zai" aria-label="Anchor link for: dai-ma-xia-zai">ğŸ”—</a>
ä»£ç ä¸‹è½½</h1>
<ol>
<li><a href="https://www.wangbo.im/posts/2016-03-30-learning-java-concurrency-cyclicbarrier/CyclicBarrierCase.java">CyclicBarrierCase.java</a></li>
</ol>

        </div>
        
    
</div></div>
            
    <div class="pagination">
        <div class="pagination__buttons">
            </div>
    </div>
<footer class="footer">
                    <div class="footer__inner"><div class="copyright copyright--user"><span>Â© 2019 <a href="https://www.wangbo.im">wangbo&apos; blog</a> :: <a href="https://github.wangbo.im">Github</a> :: Powered by <a href="https://www.getzola.org/">Zola</a></span></div>
    <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;assets&#x2F;js&#x2F;main.js"></script>
</div>
                    

                </footer></div>
    </body>
</html>
