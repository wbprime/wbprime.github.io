<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Learning Java Concurrency - ReentrantLock &amp; Condition - Elvis Wang</title>
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="wangboâ€™s home &amp; blog"/>

    <meta property="og:title" content="
    wangboâ€™s home &amp; blog -&nbsp;Learning Java Concurrency - ReentrantLock &amp; Condition" />
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-07-learning-java-concurrency-reentrantlock-condition&#x2F;"/>
    <meta property="og:description" content="&lt;p&gt;&lt;code&gt;ReentrantLock&lt;&#x2F;code&gt;æ˜¯&lt;code&gt;synchronized&lt;&#x2F;code&gt;çš„é«˜é˜¶ç‰ˆæœ¬ï¼Œç”¨æ¥æ§åˆ¶å¤šçº¿ç¨‹åŒæ­¥ã€‚&lt;code&gt;ReentrantLock&lt;&#x2F;code&gt;æ˜¯ä¸€ç§ç‹¬å é”ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€æŠŠé”ï¼Œå…¶ä»–è¯·æ±‚åŠ é”çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚é™¤äº†æ§åˆ¶å¤šçº¿ç¨‹â€¦"/>
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;style.css">
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;color&#x2F;blue.css">
<link rel="shortcut icon" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;favicon.ico" type="image/x-icon" /></head>
    <body>
        <div class="container full">
<header class="header">
    <div class="header__inner">
        <div class="header__logo">
            <a href="&#x2F;">
    <div class="logo">
        WB Prime
    </div>
</a>
        </div>
        <div class="menu-trigger">menu</div>
    </div>
    
    <nav class="menu">
        <ul class="menu__inner menu__inner--desktop">
            
            
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
                    </li>
                
            </ul>

        <ul class="menu__inner menu__inner--mobile">
            
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
        </li>
        </ul>
    </nav>

    </header>
<div class="content"><div class="post">
        <h1 class="post-title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-07-learning-java-concurrency-reentrantlock-condition&#x2F;">Learning Java Concurrency - ReentrantLock &amp; Condition</a>
        </h1>
        
    <div class="post-meta">
        <span class="post-date">2016.04.07
                </span>

        <span class="post-author"></span>

        

    
    :: {<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories&#x2F;learning-java-concurrency&#x2F;">Learning Java Concurrency</a>} 

            
    ::
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;java&#x2F;">java</a>
        
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;concurrency&#x2F;">concurrency</a>
        
    
            
        
    </div>



        

        <div class="post-content">
            <p><code>ReentrantLock</code>æ˜¯<code>synchronized</code>çš„é«˜é˜¶ç‰ˆæœ¬ï¼Œç”¨æ¥æ§åˆ¶å¤šçº¿ç¨‹åŒæ­¥ã€‚<code>ReentrantLock</code>æ˜¯ä¸€ç§ç‹¬å é”ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€æŠŠé”ï¼Œå…¶ä»–è¯·æ±‚åŠ é”çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚é™¤äº†æ§åˆ¶å¤šçº¿ç¨‹åŒæ­¥ä¹‹å¤–ï¼Œ<code>ReentrantLock</code>è¿˜æä¾›äº†<code>Condition</code>ç”¨æ¥è¿›è¡Œå¤šçº¿ç¨‹é€šè®¯ã€‚<code>Condition</code>æ˜¯<code>Object</code>ç±»çš„æ–¹æ³•<code>wait &amp; notify</code>çš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨ç­‰å¾…/é€šçŸ¥æ¨¡å¼æ¥æœ‰æ•ˆæ§åˆ¶å¤šçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚</p>
<p>ä»¿<a href="https://www.wangbo.im/posts/learning-java-concurrency-synchronized/"><code>synchronized</code></a>ï¼Œç”¨<code>ReentrantLock</code>å®ç°å•ä¾‹æ¨¡å¼çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">Singleton {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static volatile </span><span style="color:#dcdcdc;">Singleton INSTANCE;
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static </span><span style="color:#dcdcdc;">ReentrantLock lock = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">ReentrantLock();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private </span><span style="color:#dcdcdc;">Singleton() {}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public static </span><span style="color:#dcdcdc;">Singleton instance() {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">Singleton </span><span style="color:#569cd6;">var </span><span style="color:#dcdcdc;">= </span><span style="color:#b4cea8;">INSTANCE</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">null </span><span style="color:#dcdcdc;">== var) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">lock.lock();
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">var </span><span style="color:#dcdcdc;">= </span><span style="color:#b4cea8;">INSTANCE</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">null </span><span style="color:#dcdcdc;">== var) {
</span><span style="color:#dcdcdc;">                    </span><span style="color:#b4cea8;">INSTANCE </span><span style="color:#dcdcdc;">= var = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">Singleton();
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">finally </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">lock.unlock();
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">return var</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>ä»¿<a href="https://www.wangbo.im/posts/2016-04-06-learning-java-concurrency-wait-notify/"><code>wait &amp; notify</code></a>ï¼Œç”¨<code>Condition</code>æ¥å®ç°çˆ¶å­é€šçŸ¥æ±‡æ¬¾çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">DepositAccount {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private int </span><span style="color:#dcdcdc;">money;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private final </span><span style="color:#dcdcdc;">ReentrantLock lock = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">ReentrantLock();
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private final </span><span style="color:#dcdcdc;">Condition cond = lock.newCondition();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">DepositAccount() {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">this.money = </span><span style="color:#b5cea8;">0</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public void </span><span style="color:#dcdcdc;">withdraw(</span><span style="color:#569cd6;">final int </span><span style="color:#dcdcdc;">val) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">lock.lock();
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">while </span><span style="color:#dcdcdc;">(money &lt; val) {
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">cond.await(); </span><span style="color:#608b4e;">// é’±ä¸å¤Ÿï¼Œç­‰ä¸€ä¼šå„¿
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">                    </span><span style="color:#608b4e;">// do nothing here
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">money -= val;
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">finally </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">lock.unlock();
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public void </span><span style="color:#dcdcdc;">deposite(</span><span style="color:#569cd6;">final int </span><span style="color:#dcdcdc;">val) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">lock.lock();
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">money += val;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">cond.signalAll(); </span><span style="color:#608b4e;">// å­˜å®Œé’±å‘¨çŸ¥ä¸€ä¸‹
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">finally </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">lock.unlock();
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre><p><a name="continue-reading"></a></p>
<h1 id="reentrantlock-s-api"><a class="zola-anchor" href="#reentrantlock-s-api" aria-label="Anchor link for: reentrantlock-s-api">ğŸ”—</a>
ReentrantLock's API</h1>
<ol>
<li>ReentrantLock() &amp; ReentrantLock(boolean fair)</li>
<li>void lock()</li>
<li>void lockInterruptibly() throws InterruptedException</li>
<li>boolean tryLock()</li>
<li>boolean tryLock(long timeout, TimeUnit unit)</li>
<li>void unlock()</li>
<li>boolean isHelpByCurrentThread()</li>
<li>boolean isLocked()</li>
<li>boolean isFair()</li>
<li>Condition newCondition()</li>
<li>boolean hasWaiters(Condition cond)</li>
</ol>
<p><code>ReentrantLock</code>çš„å®ç°æ˜¯å§”æ‰˜ç»™å†…éƒ¨é™æ€ç±»<code>FairSync</code>å’Œ<code>NonfairSync</code>ï¼Œè¿™ä¸¤ä¸ªç±»åˆç»§æ‰¿è‡ª<code>AbstractQueuedSynchronizer</code>ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">abstract static class </span><span style="color:#dcdcdc;">Sync </span><span style="color:#569cd6;">extends </span><span style="color:#4ec9b0;">AbstractQueuedSynchronizer </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">...
</span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#569cd6;">static final class </span><span style="color:#dcdcdc;">NonfairSync </span><span style="color:#569cd6;">extends </span><span style="color:#4ec9b0;">Sync </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">...
</span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#569cd6;">static final class </span><span style="color:#dcdcdc;">FairSync </span><span style="color:#569cd6;">extends </span><span style="color:#4ec9b0;">Sync </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">...
</span><span style="color:#dcdcdc;">}
</span></pre><h2 id="gong-ping-suo-yu-fei-gong-ping-suo"><a class="zola-anchor" href="#gong-ping-suo-yu-fei-gong-ping-suo" aria-label="Anchor link for: gong-ping-suo-yu-fei-gong-ping-suo">ğŸ”—</a>
å…¬å¹³é”ä¸éå…¬å¹³é”</h2>
<p><code>FairSync</code>å’Œ<code>NonfairSync</code>å³æ‰€è°“çš„å…¬å¹³é”å’Œéå…¬å¹³é”ã€‚å¯¹æ¯”ä¸€ä¸‹ä¸¤ä¸ªé”ç‰ˆæœ¬å¯¹äº<code>lock</code>æ–¹æ³•çš„å®ç°ï¼Œå°±èƒ½æ˜ç™½å…¬å¹³å’Œéå…¬å¹³çš„åŒºåˆ«åœ¨å“ªé‡Œäº†ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">final</span><span style="color:#dcdcdc;"> void lock() { </span><span style="color:#608b4e;">// NonfairSync
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(compareAndSetState(</span><span style="color:#b5cea8;">0</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">))
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">setExclusiveOwnerThread(Thread.currentThread());
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">else
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">acquire(</span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#569cd6;">final</span><span style="color:#dcdcdc;"> void lock() { </span><span style="color:#608b4e;">// FairSync
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">acquire(</span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå…¬å¹³é”ç›´æ¥è®©å½“å‰çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼›è€Œéå…¬å¹³é”é¦–å…ˆè¯•å›¾å»è·å–é”ï¼Œå¦‚æœå½“å‰æœ‰çº¿ç¨‹æ°å¥½é‡Šæ”¾äº†é”ï¼Œå°±å¯ä»¥æ’é˜Ÿè·å–åˆ°é”ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œè¿˜æ˜¯ä¼šåŠ å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéå…¬å¹³é”ä¼šåœ¨è°ƒç”¨lockçš„æ—¶å€™å»å°è¯•è·å–é”ã€‚å¦‚æœè¿™æ—¶å€™èƒ½å¤Ÿè·å–é”ï¼Œå°±ç›´æ¥è·å–åˆ°é”ï¼Œè¿™æ ·å¯ä»¥å‡å°‘çº¿ç¨‹æŒ‚èµ·å’Œæ¢å¤çš„æ€§èƒ½å¼€é”€ï¼›ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æœ‰å¯èƒ½æ°¸è¿œæ‹¿ä¸åˆ°é”ã€‚</p>
<p><code>ReentrantLock</code>åœ¨æ„é€ å™¨ä¸­å¯ä»¥æŒ‡å®šä½¿ç”¨å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ç­–ç•¥ï¼Œé»˜è®¤æ˜¯éå…¬å¹³é”ã€‚</p>
<h2 id="lock"><a class="zola-anchor" href="#lock" aria-label="Anchor link for: lock">ğŸ”—</a>
<code>lock</code></h2>
<p><code>lock()</code>å’Œ<code>lockInterruptibly()</code>ç”¨äºè·å–é”ã€‚è°ƒç”¨çº¿ç¨‹è¯•å›¾å»è·å–ä¸€ä¸ªé”ï¼Œå¦‚æœé”å·²ç»è¢«å½“å‰çº¿ç¨‹å ç”¨ï¼Œåˆ™é”çš„è®¡æ•°å™¨åŠ 1ï¼›å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œåˆ™å½“å‰çº¿ç¨‹è¢«é˜»å¡ï¼Œè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ç­‰å¾…é”è¢«é‡Šæ”¾ã€‚</p>
<p>ä¸¤è€…çš„åŒºåˆ«åœ¨äºç­‰å¾…çº¿ç¨‹åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­æ˜¯å¦å¯ä»¥è¢«ä¸­æ–­ã€‚</p>
<h2 id="trylock"><a class="zola-anchor" href="#trylock" aria-label="Anchor link for: trylock">ğŸ”—</a>
<code>tryLock</code></h2>
<p>å¦‚æœè°ƒç”¨çº¿ç¨‹ä¸æƒ³è¢«é˜»å¡ï¼Œå¯ä»¥ä½¿ç”¨<code>lock</code>çš„å¼‚æ­¥ç‰ˆæœ¬<code>tryLock</code>ã€‚<code>tryLock</code>ä¼šè¯•å›¾å»è·å–é”ï¼Œå¦‚æœè·å–æˆåŠŸäº†ï¼Œå°±è¿”å›æˆåŠŸï¼›å¦‚æœå¤±è´¥äº†ï¼Œå°±ä¼šè¿”å›å¤±è´¥ã€‚è·å–å¤±è´¥ï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªç­‰å¾…æ—¶é—´ï¼Œè‡ªæ—‹ç­‰å¾…ã€‚</p>
<h2 id="unlock"><a class="zola-anchor" href="#unlock" aria-label="Anchor link for: unlock">ğŸ”—</a>
<code>unlock</code></h2>
<p>å¦‚æœè°ƒç”¨çº¿ç¨‹æŒæœ‰äº†ç›®æ ‡é”ï¼Œå½“å‰çº¿ç¨‹è°ƒç”¨<code>unlock</code>ä¼šè¯•å›¾é‡Šæ”¾é”å®šã€‚å‡†ç¡®çš„è¯´æ˜¯è®©ç›®æ ‡é”çš„è®¡æ•°å™¨å‡1,å¦‚æœç›®æ ‡é”çš„è®¡æ•°å™¨ä¸º0,åˆ™é”è¢«é‡Šæ”¾ã€‚</p>
<p>å¦‚æœè°ƒç”¨çº¿ç¨‹æ²¡æœ‰æŒæœ‰ç›®æ ‡é”ï¼Œä¼šå¯¼è‡´<code>IllegalMonitorStateException</code>å¼‚å¸¸ã€‚</p>
<h2 id="newcondition"><a class="zola-anchor" href="#newcondition" aria-label="Anchor link for: newcondition">ğŸ”—</a>
<code>newCondition</code></h2>
<p>åˆ›å»ºä¸€ä¸ªä¸ç›®æ ‡é”ç›¸å…³è”çš„<code>Condition</code>å¯¹è±¡ã€‚</p>
<h1 id="condition-s-api"><a class="zola-anchor" href="#condition-s-api" aria-label="Anchor link for: condition-s-api">ğŸ”—</a>
Condition's API</h1>
<ol>
<li>void await() throws InterruptedException</li>
<li>void awaitUninterruptibly()</li>
<li>long awaitNanos(long nanos) throws InterruptedException</li>
<li>boolean await(long timeout, TimeUnit unit) throws InterruptedException</li>
<li>boolean awaitUnit(Date dt) throws InterruptedException</li>
<li>void signal()</li>
<li>void signalAll()</li>
</ol>
<p><code>Condition</code>çš„ä½œç”¨å’Œç”¨æ³•å¯ä»¥å‚è€ƒ<code>Object</code>ç±»çš„<code>wait &amp; notify</code>æ—ã€‚</p>
<p><code>ReentrantLock</code>è¿”å›çš„<code>Condition</code>å¯¹è±¡ä¸ä¸€ä¸ªäº’æ–¥é”ç›¸å…³è”ã€‚<code>Condition</code>å¯¹è±¡æœ¬èº«ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œ<code>await</code>ä¼šå°†è°ƒç”¨çº¿ç¨‹æ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼›<code>signal</code>ä¼šå°†ç­‰å¾…çº¿ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹æ”¾åˆ°å…³è”çš„<code>ReentrantLock</code>å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚è¿™æ ·çº¿ç¨‹çš„æŒ‚èµ·å’Œå”¤é†’å·¥ä½œå°±ç”±<code>ReentrantLock</code>å¯¹è±¡å®Œæˆã€‚</p>
<h2 id="await"><a class="zola-anchor" href="#await" aria-label="Anchor link for: await">ğŸ”—</a>
<code>await</code></h2>
<p>åŒ<code>Object</code>çš„<code>wait</code>æ—ï¼Œä¼°è®¡å°±æ˜¯å› ä¸ºå·²ç»æœ‰äº†<code>wait</code>ï¼Œæ‰€ä»¥æ–°çš„APIæ‰è¢«å‘½åä¸º<code>await</code>ã€‚</p>
<p>è°ƒç”¨çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œä¸€ç›´ç­‰åˆ°æ¡ä»¶æ»¡è¶³è¢«å…¶ä»–çº¿ç¨‹ç”¨<code>signal</code>æ¥å”¤é†’ã€‚</p>
<p>ç­‰å¾…å¯ä»¥è®¾ç½®å…ä¸å…è®¸ä¸­æ–­ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ç­‰å¾…æ—¶é—´é—´éš”ã€‚</p>
<p>è°ƒç”¨çº¿ç¨‹è¢«æŒ‚èµ·ä¹‹åä¼šé‡Šæ”¾æŒæœ‰çš„é”ï¼ŒåŠ å…¥åˆ°<code>Condition</code>å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­å»ã€‚</p>
<h2 id="signal"><a class="zola-anchor" href="#signal" aria-label="Anchor link for: signal">ğŸ”—</a>
<code>signal</code></h2>
<p>åŒ<code>Object</code>çš„<code>notify</code>æ—ã€‚</p>
<p><code>signal</code>å”¤é†’çº¿ç¨‹çš„é¡ºåºæ˜¯æœªå®šä¹‰çš„ï¼Œä¸åŒçš„JVMå®ç°ä¼šæœ‰ä¸åŒçš„ç­–ç•¥ï¼Œå¯ä»¥æ˜¯ç­‰å¾…æ—¶é—´æœ€é•¿çš„æœ€å…ˆè¢«å”¤é†’ã€‚</p>
<p><code>signal</code>ä¼šå°†éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»<code>Condition</code>è‡ªå·±çš„ç­‰å¾…é˜Ÿåˆ—ç§»åŠ¨åˆ°ç»‘å®šçš„<code>ReentrantLock</code>å¯¹è±¡çš„ç­‰å¾…åºåˆ—ï¼ŒæŒ‰ç…§<code>ReentrantLock</code>çš„è§„åˆ™å»è·å–é”ã€‚</p>
<h1 id="dai-ma-xia-zai"><a class="zola-anchor" href="#dai-ma-xia-zai" aria-label="Anchor link for: dai-ma-xia-zai">ğŸ”—</a>
ä»£ç ä¸‹è½½</h1>
<p><a href="https://www.wangbo.im/posts/2016-04-07-learning-java-concurrency-reentrantlock-condition/ConditionCase.java">ConditionCase.java</a>
<a href="https://www.wangbo.im/posts/2016-04-07-learning-java-concurrency-reentrantlock-condition/ReentrantLockCase.java">ReentrantLockCase.java</a></p>

        </div>
        
    
</div></div>
            
    <div class="pagination">
        <div class="pagination__buttons">
            </div>
    </div>
<footer class="footer">
                    <div class="footer__inner"><div class="copyright">
            <span>Â© 2019 <a href="https://github.com/ejmg/zerm">zerm</a> :: Powered by <a href="https://www.getzola.org/">Zola</a></span>
            <span>:: Theme made by <a href="https://github.com/ejmg">ejmg</a></span>
        </div>
    <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;assets&#x2F;js&#x2F;main.js"></script>
</div>
                    

                </footer></div>
    </body>
</html>
