

<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>wangbo’s home &amp; blog - Learning Java Concurrency - wait &amp; notify</title>

      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
      

      
          <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;site.css">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">WB Prime</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im">
                            Home
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;tags">
                            Tags
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;about">
                            About
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;github.wangbo.im">
                            Github
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;www.wangbo.im">WB Prime</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https://www.wangbo.im">
                                    Home
                                </a>
                            </li>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;tags">
                                    Tags
                                </a>
                            </li>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;github.wangbo.im">
                                    Github
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    



<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-06-learning-java-concurrency-wait-notify&#x2F;">Learning Java Concurrency - wait &amp; notify</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2016-04-06</span>
            
        </div>
    </header>

    <div class="post-content">
      <p>在synchronized关键字之外，Java提供了另外的<code>wait</code>和<code>notify</code>函数族用于支援多线程通信，使用上类似于JUC的Condition类。</p>
<p><code>wait()</code>、<code>notify()</code>和<code>notifyAll()</code>是Object类的方法，与synchronized配套使用。</p>
<pre style="background-color:#2b303b;">
<span style="color:#b48ead;">public class </span><span style="color:#ebcb8b;">Object </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">...
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public final native void </span><span style="color:#8fa1b3;">wait</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">long </span><span style="color:#bf616a;">timeout</span><span style="color:#eff1f5;">) </span><span style="color:#b48ead;">throws </span><span style="color:#ebcb8b;">InterruptedException</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public final void </span><span style="color:#8fa1b3;">wait</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">long </span><span style="color:#bf616a;">timeout</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">nanos</span><span style="color:#eff1f5;">) </span><span style="color:#b48ead;">throws </span><span style="color:#ebcb8b;">InterruptedException</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public final void </span><span style="color:#8fa1b3;">wait</span><span style="color:#eff1f5;">() </span><span style="color:#b48ead;">throws </span><span style="color:#ebcb8b;">InterruptedException</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public final native void </span><span style="color:#8fa1b3;">notify</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public final native void </span><span style="color:#8fa1b3;">notifyAll</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">...
</span><span style="color:#eff1f5;">}
</span></pre>
<p><code>wait</code>一共有三个函数。调用<code>wait</code>的线程必须已经持有了同一个对象的同步器（使用synchronized）。调用<code>wait</code>的线程会进入等待状态，直到另外的线程调用了同一个对象的<code>notify</code>函数，或者指定的等待时间过期，或者被中断（引发InterruptedException）。调用<code>wait</code>函数之后，当前线程会放弃已经持有的同步器。</p>
<p><code>notify</code>一共是有两个函数。<code>notify()</code>函数会唤醒当前的由于执行<code>wait</code>而进入等待的某个线程；注意，被唤醒的线程是不可预料的，也就是说不同的JVM实现可以用不同的规则算法来决定被唤醒的是哪一个线程。<code>notifyAll()</code>函数会唤醒所有的等待线程，但是只会有一个线程最终进入执行。</p>
<p><a name="continue-reading"></a></p>
<p>下面用两个例子来说明<code>wait &amp; notify</code>的使用场景和使用方式。</p>
<h1 id="yin-xing-qu-qian"><a class="zola-anchor" href="#yin-xing-qu-qian" aria-label="Anchor link for: yin-xing-qu-qian">🔗</a>
银行取钱</h1>
<p>银行取钱是传统的生产者和消费者模型的一个简化版本。</p>
<p>假设有一个银行账户，两个用户分别要往里面存钱和取钱（可以想象为一个通知汇款，儿子在上大学要花钱，打电话让父亲给打钱；两个ATM机，父亲手哆嗦地五百五百地存，儿子不耐烦地刷，有钱就取出来）。</p>
<h2 id="dai-ma"><a class="zola-anchor" href="#dai-ma" aria-label="Anchor link for: dai-ma">🔗</a>
代码</h2>
<pre style="background-color:#2b303b;">
<span style="color:#b48ead;">package </span><span style="color:#c0c5ce;">me.wbprime.showcase.concurrent;
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">java.util.concurrent.</span><span style="color:#ebcb8b;">ExecutorService</span><span style="color:#c0c5ce;">;
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">java.util.concurrent.</span><span style="color:#ebcb8b;">Executors</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;">/**
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">* Class: DepositCase
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">* Date: 2016/04/05 14:42
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">*/
</span><span style="color:#b48ead;">public class </span><span style="color:#ebcb8b;">DepositCase </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">DepositAccount </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private int </span><span style="color:#eff1f5;">money;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">DepositAccount</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.money </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public synchronized void </span><span style="color:#8fa1b3;">withdraw</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">val</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(money </span><span style="color:#c0c5ce;">&lt;</span><span style="color:#eff1f5;"> val) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">wait</span><span style="color:#eff1f5;">(); </span><span style="color:#65737e;">// 钱不够，等一会儿
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing here
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">money </span><span style="color:#c0c5ce;">-=</span><span style="color:#eff1f5;"> val;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public synchronized void </span><span style="color:#8fa1b3;">deposite</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">val</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">money </span><span style="color:#c0c5ce;">+=</span><span style="color:#eff1f5;"> val;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">notifyAll</span><span style="color:#eff1f5;">(); </span><span style="color:#65737e;">// 存完钱周知一下
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">OldFather </span><span style="color:#b48ead;">implements </span><span style="color:#a3be8c;">Runnable </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private </span><span style="color:#ebcb8b;">DepositAccount </span><span style="color:#eff1f5;">account;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final int </span><span style="color:#eff1f5;">totalMoney;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private int </span><span style="color:#eff1f5;">depositedMoney;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">OldFather</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">DepositAccount </span><span style="color:#bf616a;">account</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">val</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.account </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> account;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.totalMoney </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> val;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.depositedMoney </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public void </span><span style="color:#8fa1b3;">run</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">final int </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">5000</span><span style="color:#eff1f5;">; </span><span style="color:#65737e;">// 每次最多存这么多钱
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(depositedMoney </span><span style="color:#c0c5ce;">&lt;</span><span style="color:#eff1f5;"> totalMoney) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> moneyEachTime </span><span style="color:#c0c5ce;">=
</span><span style="color:#eff1f5;">                    </span><span style="color:#eff1f5;">(totalMoney </span><span style="color:#c0c5ce;">-</span><span style="color:#eff1f5;"> depositedMoney) </span><span style="color:#c0c5ce;">&lt; </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME </span><span style="color:#c0c5ce;">? </span><span style="color:#eff1f5;">(totalMoney </span><span style="color:#c0c5ce;">-</span><span style="color:#eff1f5;"> depositedMoney) </span><span style="color:#c0c5ce;">: </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">account.</span><span style="color:#bf616a;">deposite</span><span style="color:#eff1f5;">(moneyEachTime);
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">depositedMoney </span><span style="color:#c0c5ce;">+=</span><span style="color:#eff1f5;"> moneyEachTime;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#ebcb8b;">System</span><span style="color:#eff1f5;">.out.</span><span style="color:#bf616a;">println</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">父亲 sent </span><span style="color:#c0c5ce;">&quot; +</span><span style="color:#eff1f5;"> moneyEachTime </span><span style="color:#c0c5ce;">+ &quot;</span><span style="color:#a3be8c;"> RMB to his son</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#ebcb8b;">Thread</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">sleep</span><span style="color:#eff1f5;">(</span><span style="color:#d08770;">5000</span><span style="color:#eff1f5;">); </span><span style="color:#65737e;">// 缓口气
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">Son </span><span style="color:#b48ead;">implements </span><span style="color:#a3be8c;">Runnable </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final </span><span style="color:#ebcb8b;">String </span><span style="color:#eff1f5;">name;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private </span><span style="color:#ebcb8b;">DepositAccount </span><span style="color:#eff1f5;">account;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final int </span><span style="color:#eff1f5;">neededMoney;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private int </span><span style="color:#eff1f5;">availMoney;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">Son</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">String </span><span style="color:#bf616a;">name</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">DepositAccount </span><span style="color:#bf616a;">account</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">money</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.name </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> name;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.account </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> account;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.neededMoney </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> money;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.availMoney </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public void </span><span style="color:#8fa1b3;">run</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">final int </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">1000</span><span style="color:#eff1f5;">; </span><span style="color:#65737e;">// 每次最多取这么多钱
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(availMoney </span><span style="color:#c0c5ce;">&lt;</span><span style="color:#eff1f5;"> neededMoney) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> moneyEachTime </span><span style="color:#c0c5ce;">=
</span><span style="color:#eff1f5;">                    </span><span style="color:#eff1f5;">(neededMoney </span><span style="color:#c0c5ce;">-</span><span style="color:#eff1f5;"> availMoney) </span><span style="color:#c0c5ce;">&lt; </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME </span><span style="color:#c0c5ce;">? </span><span style="color:#eff1f5;">(neededMoney </span><span style="color:#c0c5ce;">-</span><span style="color:#eff1f5;"> availMoney) </span><span style="color:#c0c5ce;">: </span><span style="color:#d08770;">MAX_MONEY_EACH_TIME</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">account.</span><span style="color:#bf616a;">withdraw</span><span style="color:#eff1f5;">(moneyEachTime);
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">availMoney </span><span style="color:#c0c5ce;">+=</span><span style="color:#eff1f5;"> moneyEachTime;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#ebcb8b;">System</span><span style="color:#eff1f5;">.out.</span><span style="color:#bf616a;">println</span><span style="color:#eff1f5;">(name </span><span style="color:#c0c5ce;">+ &quot;</span><span style="color:#a3be8c;"> get </span><span style="color:#c0c5ce;">&quot; +</span><span style="color:#eff1f5;"> moneyEachTime </span><span style="color:#c0c5ce;">+ &quot;</span><span style="color:#a3be8c;"> RMB from his father</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#ebcb8b;">Thread</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">sleep</span><span style="color:#eff1f5;">(</span><span style="color:#d08770;">1000</span><span style="color:#eff1f5;">); </span><span style="color:#65737e;">// 抽根烟
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public static void </span><span style="color:#8fa1b3;">main</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">String</span><span style="color:#b48ead;">[] </span><span style="color:#bf616a;">args</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">DepositAccount</span><span style="color:#eff1f5;"> account </span><span style="color:#c0c5ce;">= </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">DepositAccount</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">ExecutorService</span><span style="color:#eff1f5;"> executorService </span><span style="color:#c0c5ce;">= </span><span style="color:#ebcb8b;">Executors</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">newCachedThreadPool</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> moneyToSon1 </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">10000</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> moneyToSon2 </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">18600</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> moneyToSon3 </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">10240</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">OldFather</span><span style="color:#eff1f5;">(account, moneyToSon1 </span><span style="color:#c0c5ce;">+</span><span style="color:#eff1f5;"> moneyToSon2 </span><span style="color:#c0c5ce;">+</span><span style="color:#eff1f5;"> moneyToSon3)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Son</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">胡大</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">, account, moneyToSon1)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Son</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">胡二</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">, account, moneyToSon2)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Son</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">胡三</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">, account, moneyToSon3)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">shutdown</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">}
</span></pre><h2 id="dai-ma-shuo-ming"><a class="zola-anchor" href="#dai-ma-shuo-ming" aria-label="Anchor link for: dai-ma-shuo-ming">🔗</a>
代码说明</h2>
<ol>
<li><code>DepositAccount</code>类表征银行存款帐号，主要记录当前有多少钱，并提供同步的存款、取款的方法。取钱的钱不够了就没法取，只能等着；存钱的就没关系，可以一直往里面存，每存一笔钱就通知一遍要取钱的人。</li>
<li><code>OldFather</code>类表征存钱的父亲，连续往账户里面存钱，每次存钱都有一个限额。父亲每存一笔钱，要叹一口气。</li>
<li><code>Son</code>类表征在外的儿子（们），缺钱了去取钱，每次取钱有限额。如果账户里面没有钱了，只能抽一根烟等着了。</li>
<li><code>main()</code>函数，首先构造帐号，然后构造父亲和儿子（胡大、胡二和胡三），然后用一个线程池跑起来。</li>
</ol>
<p>代码很简单。</p>
<h1 id="ling-hu-chong-bei-kun-xi-hu-di"><a class="zola-anchor" href="#ling-hu-chong-bei-kun-xi-hu-di" aria-label="Anchor link for: ling-hu-chong-bei-kun-xi-hu-di">🔗</a>
令狐冲被困西湖底</h1>
<p>另外一个例子可以考虑令狐冲被困在西湖底下面的情形。</p>
<p>冲哥被困在了西湖底的地牢里面，不见天日。梅庄四友发善心，每天都让人送饭给他吃。</p>
<p>现在来看，冲哥要吃饭，只能等人送饭过来；送饭的人是个聋哑人，到点了过来看一下，发现饭被吃了，就给一份新的饭。也就是，一个人送一个人吃；吃完了才送，没吃完不送；送来了才有得吃，没送就没得吃。</p>
<p>代码说话。</p>
<h2 id="dai-ma-1"><a class="zola-anchor" href="#dai-ma-1" aria-label="Anchor link for: dai-ma-1">🔗</a>
代码</h2>
<pre style="background-color:#2b303b;">
<span style="color:#b48ead;">package </span><span style="color:#c0c5ce;">me.wbprime.showcase.concurrent;
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">java.util.concurrent.</span><span style="color:#ebcb8b;">ExecutorService</span><span style="color:#c0c5ce;">;
</span><span style="color:#b48ead;">import </span><span style="color:#c0c5ce;">java.util.concurrent.</span><span style="color:#ebcb8b;">Executors</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;">/**
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">* Class: LinghuChongCase
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">* Date: 2016/04/06 12:38
</span><span style="color:#65737e;"> </span><span style="color:#65737e;">*/
</span><span style="color:#b48ead;">public class </span><span style="color:#ebcb8b;">LinghuChongCase </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">Bowl </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private boolean </span><span style="color:#eff1f5;">isFull;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public synchronized void </span><span style="color:#8fa1b3;">eat</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">!</span><span style="color:#eff1f5;"> isFull) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">wait</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">isFull </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">false</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">notifyAll</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public synchronized void </span><span style="color:#8fa1b3;">provide</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(isFull) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">wait</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">isFull </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">true</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">notifyAll</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">LinghuChong </span><span style="color:#b48ead;">implements </span><span style="color:#a3be8c;">Runnable</span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final </span><span style="color:#ebcb8b;">Bowl </span><span style="color:#eff1f5;">bowl;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final int </span><span style="color:#eff1f5;">days;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">LinghuChong</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">Bowl </span><span style="color:#bf616a;">bowl</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">days</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.bowl </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> bowl;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.days </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> days;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public void </span><span style="color:#8fa1b3;">run</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> existingDays </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(existingDays </span><span style="color:#c0c5ce;">&lt;</span><span style="color:#eff1f5;"> days) {
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">bowl.</span><span style="color:#bf616a;">eat</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#ebcb8b;">System</span><span style="color:#eff1f5;">.out.</span><span style="color:#bf616a;">println</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">Linghu Chong enjoys eating，</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#ebcb8b;">Thread</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">sleep</span><span style="color:#eff1f5;">(</span><span style="color:#d08770;">1000</span><span style="color:#eff1f5;">); </span><span style="color:#65737e;">// 练吸心大法
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">existingDays </span><span style="color:#c0c5ce;">++</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">private static class </span><span style="color:#ebcb8b;">SomeBody </span><span style="color:#b48ead;">implements </span><span style="color:#a3be8c;">Runnable</span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final </span><span style="color:#ebcb8b;">Bowl </span><span style="color:#eff1f5;">bowl;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">private final int </span><span style="color:#eff1f5;">days;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">SomeBody</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">Bowl </span><span style="color:#bf616a;">bowl</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">final int </span><span style="color:#bf616a;">days</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.bowl </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> bowl;
</span><span style="color:#eff1f5;">            </span><span style="color:#bf616a;">this</span><span style="color:#eff1f5;">.days </span><span style="color:#c0c5ce;">=</span><span style="color:#eff1f5;"> days;
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">public void </span><span style="color:#8fa1b3;">run</span><span style="color:#eff1f5;">() {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> existingDays </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(existingDays </span><span style="color:#c0c5ce;">&lt;</span><span style="color:#eff1f5;"> days) {
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">bowl.</span><span style="color:#bf616a;">provide</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#ebcb8b;">System</span><span style="color:#eff1f5;">.out.</span><span style="color:#bf616a;">println</span><span style="color:#eff1f5;">(</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">Prepared a bowl for a prisoner to eat</span><span style="color:#c0c5ce;">&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">try </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">                    </span><span style="color:#ebcb8b;">Thread</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">sleep</span><span style="color:#eff1f5;">(</span><span style="color:#d08770;">2000</span><span style="color:#eff1f5;">); </span><span style="color:#65737e;">// 不知道干嘛
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">} </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(</span><span style="color:#ebcb8b;">InterruptedException </span><span style="color:#bf616a;">e</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">                    </span><span style="color:#65737e;">// do nothing
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">                </span><span style="color:#eff1f5;">existingDays</span><span style="color:#c0c5ce;">++</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">public static void </span><span style="color:#8fa1b3;">main</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">String</span><span style="color:#b48ead;">[] </span><span style="color:#bf616a;">args</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">Bowl</span><span style="color:#eff1f5;"> bowl </span><span style="color:#c0c5ce;">= </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Bowl</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final </span><span style="color:#ebcb8b;">ExecutorService</span><span style="color:#eff1f5;"> executorService </span><span style="color:#c0c5ce;">= </span><span style="color:#ebcb8b;">Executors</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">newCachedThreadPool</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">final int</span><span style="color:#eff1f5;"> daysLostFreedom </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">15</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">LinghuChong</span><span style="color:#eff1f5;">(bowl, daysLostFreedom)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">execute</span><span style="color:#eff1f5;">(
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">SomeBody</span><span style="color:#eff1f5;">(bowl, daysLostFreedom)
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">        </span><span style="color:#eff1f5;">executorService.</span><span style="color:#bf616a;">shutdown</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">    </span><span style="color:#eff1f5;">}
</span><span style="color:#eff1f5;">}
</span></pre><h2 id="dai-ma-shuo-ming-1"><a class="zola-anchor" href="#dai-ma-shuo-ming-1" aria-label="Anchor link for: dai-ma-shuo-ming-1">🔗</a>
代码说明</h2>
<ol>
<li><code>Bowl</code>类表征饭碗，里面还有饭令狐冲才可以吃，送饭人就不会送；里面没饭了，令狐冲就没得吃，送饭人才会送。</li>
<li><code>LinghuChong</code>类表征令狐冲，吃饭，没饭吃的时候就练吸心大法。</li>
<li><code>SomeBody</code>类表征送饭的人，不知道干嘛的。定时送饭。</li>
<li><code>main()</code>函数，构造饭碗，构造令狐冲和送饭人，然后设定冲哥被关了半个月。</li>
</ol>
<h1 id="dai-ma-xia-zai"><a class="zola-anchor" href="#dai-ma-xia-zai" aria-label="Anchor link for: dai-ma-xia-zai">🔗</a>
代码下载</h1>
<p><a href="https://www.wangbo.im/posts/2016-04-06-learning-java-concurrency-wait-notify/DepositCase.java">DepositCase.java</a>
<a href="https://www.wangbo.im/posts/2016-04-06-learning-java-concurrency-wait-notify/LinghuChongCase.java">LinghuChongCase.java</a></p>

    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;java&#x2F;">#java</a>
                    
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;concurrency&#x2F;">#concurrency</a>
                    
                </div>
            
            
                <div class="post-nav">
                    
                        <a class="previous" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;learning-java-concurrency-synchronized&#x2F;">‹ Learning Java Concurrency - synchronized</a>
                    
                    
                        <a class="next" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-07-learning-java-concurrency-reentrantlock-condition&#x2F;">Learning Java Concurrency - ReentrantLock &amp; Condition ›</a>
                    
                    
                    
                </div>
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;even.js" ></script>
      
    </body>

</html>
