<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="443px" preserveAspectRatio="none" style="width:702px;height:443px;" version="1.1" viewBox="0 0 702 443" width="702px" zoomAndPan="magnify"><defs><filter height="300%" id="f1bsd0gch6hp8n" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="423.75" cy="20" fill="#000000" filter="url(#f1bsd0gch6hp8n)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" height="35.5914" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="482" x="182.75" y="94"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="462" x="192.75" y="116.2932">SELECT task_id FROM task WHERE task_state = NEW AND task_priority = HIGH limit 1</text><polygon fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" points="409.75,149.5914,437.75,149.5914,449.75,161.5914,437.75,173.5914,409.75,173.5914,397.75,161.5914,409.75,149.5914" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="409.75" y="165.7113">found</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="16" x="381.75" y="158.5702">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="449.75" y="158.5702">no</text><rect fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" height="35.5914" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="496" x="10" y="183.5914"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="476" x="20" y="205.8847">UPDATE task SET task_state = PROCESSING WHERE task_id = ID AND task_state = NEW</text><rect fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" height="35.5914" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="210" y="288.324"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="220" y="310.6172">return FOUND</text><ellipse cx="258" cy="355.2111" fill="none" filter="url(#f1bsd0gch6hp8n)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="258.5" cy="355.7111" fill="#000000" filter="url(#f1bsd0gch6hp8n)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" points="238,239.1829,278,239.1829,290,251.1829,278,263.1829,238,263.1829,226,251.1829,238,239.1829" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="16" x="262" y="274.4438">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="40" x="238" y="255.3027">updated</text><rect fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" height="35.5914" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="526" y="183.5914"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="536" y="205.8847">return NOT_FOUND</text><ellipse cx="589.5" cy="249.1829" fill="none" filter="url(#f1bsd0gch6hp8n)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="590" cy="249.6829" fill="#000000" filter="url(#f1bsd0gch6hp8n)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" points="423.75,50,435.75,62,423.75,74,411.75,62,423.75,50" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f1bsd0gch6hp8n)" points="406.25,407.2111,441.25,407.2111,453.25,419.2111,441.25,431.2111,406.25,431.2111,394.25,419.2111,406.25,407.2111" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="406.25" y="423.331">forever</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="258" x2="258" y1="323.9154" y2="345.2111"/><polygon fill="#A80036" points="254,335.2111,258,345.2111,262,335.2111,258,339.2111" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="258" x2="258" y1="263.1829" y2="288.324"/><polygon fill="#A80036" points="254,278.324,258,288.324,262,278.324,258,282.324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="290" x2="423.75" y1="251.1829" y2="251.1829"/><polygon fill="#A80036" points="419.75,333.9154,423.75,343.9154,427.75,333.9154,423.75,337.9154" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="423.75" x2="423.75" y1="251.1829" y2="407.2111"/><polygon fill="#A80036" points="419.75,397.2111,423.75,407.2111,427.75,397.2111,423.75,401.2111" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="258" x2="258" y1="219.1829" y2="239.1829"/><polygon fill="#A80036" points="254,229.1829,258,239.1829,262,229.1829,258,233.1829" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="589.5" x2="589.5" y1="219.1829" y2="239.1829"/><polygon fill="#A80036" points="585.5,229.1829,589.5,239.1829,593.5,229.1829,589.5,233.1829" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="397.75" x2="258" y1="161.5914" y2="161.5914"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="258" x2="258" y1="161.5914" y2="183.5914"/><polygon fill="#A80036" points="254,173.5914,258,183.5914,262,173.5914,258,177.5914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="449.75" x2="589.5" y1="161.5914" y2="161.5914"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="589.5" x2="589.5" y1="161.5914" y2="183.5914"/><polygon fill="#A80036" points="585.5,173.5914,589.5,183.5914,593.5,173.5914,589.5,177.5914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="423.75" x2="423.75" y1="129.5914" y2="149.5914"/><polygon fill="#A80036" points="419.75,139.5914,423.75,149.5914,427.75,139.5914,423.75,143.5914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="423.75" x2="423.75" y1="74" y2="94"/><polygon fill="#A80036" points="419.75,84,423.75,94,427.75,84,423.75,88" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="453.25" x2="676.75" y1="419.2111" y2="419.2111"/><polygon fill="#A80036" points="672.75,250.0283,676.75,240.0283,680.75,250.0283,676.75,246.0283" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="676.75" x2="676.75" y1="62" y2="419.2111"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="676.75" x2="435.75" y1="62" y2="62"/><polygon fill="#A80036" points="445.75,58,435.75,62,445.75,66,441.75,62" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="423.75" x2="423.75" y1="30" y2="50"/><polygon fill="#A80036" points="419.75,40,423.75,50,427.75,40,423.75,44" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

start

repeat
    :SELECT task_id FROM task WHERE task_state = NEW AND task_priority = HIGH limit 1;

    if (found) then (yes)
        :UPDATE task SET task_state = PROCESSING WHERE task_id = ID AND task_state = NEW;

        if (updated) then (yes)
            :return FOUND;
            stop
        endif
    else (no)
        :return NOT_FOUND;
        stop
    endif
repeat while (forever)

@enduml

PlantUML version 1.2018.00(Fri Jan 05 03:42:56 CST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit GraalVM EE 19.2.0
Java Version: 1.8.0_221-b11
Operating System: Linux
OS Version: 5.2.11-arch1-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>