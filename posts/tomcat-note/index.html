<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Tomcat Note - Elvis Wang</title>
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="wangbo’s home &amp; blog"/>

    <meta property="og:title" content="
    wangbo’s blog -&nbsp;Tomcat Note" />
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;tomcat-note&#x2F;"/>
    <meta property="og:description" content="Note of apache tomcat architecture"/>
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;style.css">
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;color&#x2F;red.css">
<link rel="shortcut icon" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;favicon.ico" type="image/x-icon" /></head>
    <body>
        <div class="container full">
<header class="header">
    <div class="header__inner">
        <div class="header__logo">
            <a href="&#x2F;">
    <div class="logo">
        WB Prime
    </div>
</a>
        </div>
        <div class="menu-trigger">menu</div>
    </div>
    
    <nav class="menu">
        <ul class="menu__inner menu__inner--desktop">
            
            
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
                    </li>
                
            </ul>

        <ul class="menu__inner menu__inner--mobile">
            
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
        </li>
        </ul>
    </nav>

    </header>
<div class="content"><div class="post">
        <h1 class="post-title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;tomcat-note&#x2F;">Tomcat Note</a>
        </h1>
        
    <div class="post-meta">
        <span class="post-date">2018.02.06
                </span>

        <span class="post-author"></span>

        

    
    :: {<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories&#x2F;notes&#x2F;">Notes</a>} 

            
    ::
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;tomcat&#x2F;">tomcat</a>
        
    
            
        
    </div>



        

        <div class="post-content">
            <p>Notes of
<a href="https://www.ibm.com/developerworks/cn/java/j-lo-tomcat1/index.html">Tomcat 系统架构与设计模式，第 1
部分</a> and
<a href="https://www.ibm.com/developerworks/cn/java/j-lo-tomcat2/">Tomcat 系统架构与设计模式，第 2
部分</a>.</p>
<h1 id="tomcat-architecture"><a class="zola-anchor" href="#tomcat-architecture" aria-label="Anchor link for: tomcat-architecture">🔗</a>
Tomcat Architecture</h1>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">---------------------------------------------
</span><span style="color:#fdf4c1aa;">| Server                                    |
</span><span style="color:#fdf4c1aa;">| - Service                                 |
</span><span style="color:#fdf4c1aa;">|   - Connector Coyote                      |
</span><span style="color:#fdf4c1aa;">|   - Connector Coyote                      |
</span><span style="color:#fdf4c1aa;">|   - Connector Coyote                      |
</span><span style="color:#fdf4c1aa;">|   - Connector Coyote                      |
</span><span style="color:#fdf4c1aa;">|   - ...                                   |
</span><span style="color:#fdf4c1aa;">|   - Container Catalina                    |
</span><span style="color:#fdf4c1aa;">|   - Session                               |
</span><span style="color:#fdf4c1aa;">|   - Jasper                                |
</span><span style="color:#fdf4c1aa;">|   - Naming                                |
</span><span style="color:#fdf4c1aa;">|   - Logging                               |
</span><span style="color:#fdf4c1aa;">|   - JMX                                   |
</span><span style="color:#fdf4c1aa;">---------------------------------------------
</span></pre><h1 id="structures"><a class="zola-anchor" href="#structures" aria-label="Anchor link for: structures">🔗</a>
Structures</h1>
<h2 id="lifecycle"><a class="zola-anchor" href="#lifecycle" aria-label="Anchor link for: lifecycle">🔗</a>
LifeCycle</h2>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">void addLifecycleListner(...)
</span><span style="color:#fdf4c1aa;">void removeLifecycleListener(...)
</span><span style="color:#fdf4c1aa;">LifecycleListeners findLifecycleListeners()
</span><span style="color:#fdf4c1aa;">void start()
</span><span style="color:#fdf4c1aa;">void stop()
</span></pre><h2 id="server"><a class="zola-anchor" href="#server" aria-label="Anchor link for: server">🔗</a>
Server</h2>
<p>A &quot;Server&quot; is a manager of a collection of &quot;Service&quot;.</p>
<h2 id="service"><a class="zola-anchor" href="#service" aria-label="Anchor link for: service">🔗</a>
Service</h2>
<p>A &quot;Service&quot; is a combination of a &quot;Container&quot; and multi &quot;Connector&quot; together with several utils.</p>
<h2 id="connector"><a class="zola-anchor" href="#connector" aria-label="Anchor link for: connector">🔗</a>
Connector</h2>
<p>A &quot;Connector&quot; receive http request and post http response.</p>
<p>When a http connection comes, a &quot;Connector&quot; passed it to a &quot;Processor&quot; via
<code>Processor::assign()</code>.</p>
<h2 id="processor"><a class="zola-anchor" href="#processor" aria-label="Anchor link for: processor">🔗</a>
Processor</h2>
<p>A &quot;Processor&quot; constructs a http request and response and passed it to a
&quot;Container&quot;.</p>
<h2 id="container"><a class="zola-anchor" href="#container" aria-label="Anchor link for: container">🔗</a>
Container</h2>
<p>A &quot;Container&quot; is a role, including &quot;Wrapper&quot;, &quot;Context&quot;, &quot;Host&quot; and &quot;Engine&quot;.</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">Engine
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">|- Host 0
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">|- Context
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">|- Wrapper
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">|- Host 1
</span><span style="color:#fdf4c1aa;">        </span><span style="color:#fdf4c1aa;">|- Context
</span><span style="color:#fdf4c1aa;">            </span><span style="color:#fdf4c1aa;">|- Wrapper
</span></pre><h2 id="engine"><a class="zola-anchor" href="#engine" aria-label="Anchor link for: engine">🔗</a>
Engine</h2>
<p>An &quot;Engine&quot; has no parent.</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">Engine interface
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- String get DefaultHost()
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- void setDefaultHost(String)
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- String getJvmRoute()
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- void setJvmRoute(String)
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- Service getService()
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- void setService(Service)
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- void addDefaultContext(DefaultContext)
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- DefaultContext getDefaultContext()
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">- void importDefaultContext()
</span></pre>
<p>StandardEngine implements Engine.</p>
<ul>
<li>Cluster: load balance</li>
<li>Realm: security management</li>
<li>Pipeline: logic</li>
<li>Valve: operations</li>
</ul>
<h2 id="host"><a class="zola-anchor" href="#host" aria-label="Anchor link for: host">🔗</a>
Host</h2>
<p>A &quot;Host&quot; is a deployer.</p>
<ul>
<li>Cluster: load balance</li>
<li>Realm: security management</li>
<li>Pipeline: logic</li>
<li>Valve: operations</li>
</ul>
<h2 id="context"><a class="zola-anchor" href="#context" aria-label="Anchor link for: context">🔗</a>
Context</h2>
<p>A &quot;Context&quot; is the place where to run a servlet.</p>
<ul>
<li>Cluster: load balance</li>
<li>Realm: security management</li>
<li>Pipeline: logic</li>
<li>Valve: operations</li>
<li>Manager: session management org.apache.catalina.session.StandardManager</li>
<li>Resources</li>
<li>Loader: class loader</li>
<li>Mapper: URL map to wrapper</li>
</ul>
<h2 id="wrapper"><a class="zola-anchor" href="#wrapper" aria-label="Anchor link for: wrapper">🔗</a>
Wrapper</h2>
<p>A &quot;Wrapper&quot; is a servlet.</p>
<ul>
<li>Pipeline: logic</li>
<li>Valve: operations</li>
<li>Servlet</li>
<li>Servelet stack</li>
</ul>
<p>Following classes implementing &quot;Wrapper&quot;.</p>
<ul>
<li><code>org.apache.catalina.servlets.DefaultServlet</code></li>
<li><code>org.apache.jasper.servlet.JspServlet</code></li>
</ul>
<h2 id="pipeline-and-valve"><a class="zola-anchor" href="#pipeline-and-valve" aria-label="Anchor link for: pipeline-and-valve">🔗</a>
Pipeline and Valve</h2>
<ul>
<li><code>org.apache.catalina.core.ContainerBase</code></li>
<li><code>org.apache.catalina.core.StandardEngine</code></li>
<li><code>org.apache.catalina.core.StandardHost</code></li>
<li><code>org.apache.catalina.core.StandardContext</code></li>
<li><code>org.apache.catalina.core.StandardWrapper</code></li>
<li><code>org.apache.catalina.core.StandardPipeline</code></li>
<li><code>org.apache.catalina.valves.ValveBase</code></li>
<li><code>org.apache.catalina.core.StandardEngineValve</code></li>
<li><code>org.apache.catalina.core.StandardHostValve</code></li>
<li><code>org.apache.catalina.core.StandardContextValve</code></li>
<li><code>org.apache.catalina.core.StandardWrapperValve</code></li>
</ul>

        </div>
        
    
</div></div>
            
    <div class="pagination">
        <div class="pagination__buttons">
            </div>
    </div>
<footer class="footer">
                    <div class="footer__inner"><div class="copyright copyright--user"><span>© 2019 <a href="https://www.wangbo.im">wangbo&apos; blog</a> :: <a href="https://github.wangbo.im">Github</a> :: Powered by <a href="https://www.getzola.org/">Zola</a></span></div>
    <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;assets&#x2F;js&#x2F;main.js"></script>
</div>
                    

                </footer></div>
    </body>
</html>
