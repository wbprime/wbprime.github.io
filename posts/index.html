<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>wangbo’s blog</title>

      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
      

      
          <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;site.css">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">WB Prime</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">
                            Tags
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;github.wangbo.im">
                            Github
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">
                            About
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;www.wangbo.im">WB Prime</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">
                                    Tags
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;github.wangbo.im">
                                    Github
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    
                        <div class="posts">
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;dependency-injection-practise-guice-vs-dagger2&#x2F;">Dependency Injection - Guice VS Dagger 2</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-30</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p>做 Java 后台开发的同学，基本上都使用过 <a href="http://en.wikipedia.org/wiki/Dependency_injection" title="Dependency Injection">Dependency Injection</a> 依赖注入框架。大名鼎鼎的 <a href="https://spring.io/projects/spring-framework" title="Spring Framework">Spring
Framework</a> 就是从依赖注入起家的，然后一路奔向了全家桶的不归路；<a href="https://github.com/google/guice" title="Guice (pronounced 'juice') is a lightweight dependency injection framework for Java 6 and above, brought to you by Google.">Guice</a> 是
Google 公司的依赖注入解决方案，重视类型安全胜过于使用便利性，相比 <a href="https://spring.io/projects/spring-framework" title="Spring Framework">Spring Framework</a> 能提供
更精准的控制和更翔实的注入失败错误信息；而由 Google 接盘 <a href="http://square.github.io/">Square</a> 的
<a href="https://dagger.dev/" title="Dagger is a fully static, compile-time dependency injection framework for both Java and Android.">Dagger 2</a> 则比 <a href="https://github.com/google/guice" title="Guice (pronounced 'juice') is a lightweight dependency injection framework for Java 6 and above, brought to you by Google.">Guice</a> 更进一步，通过在编译时构建依赖注入关系，使得依赖错误在编译阶
段尽量暴露出来，同时，原生类型安全的 Java 代码相较基于反射的注入代码也有或多或少的性能提升（尤其是在
Android 上）。</p>
<p>本文通过同时使用 <a href="https://github.com/google/guice" title="Guice (pronounced 'juice') is a lightweight dependency injection framework for Java 6 and above, brought to you by Google.">Guice</a> 和 <a href="https://dagger.dev/" title="Dagger is a fully static, compile-time dependency injection framework for both Java and Android.">Dagger 2</a> 来实现相同的功能，对比二者在实现依赖注入方法上
的异同。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;dependency-injection-practise-guice-vs-dagger2&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-transaction-management&#x2F;">JOOQ 的使用 - 使用事务 (Transaction)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-25</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p>本篇主要介绍 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的事务支持。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-transaction-management&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-basic-orm&#x2F;">JOOQ 的使用 - 基于代码生成的 ORM (CRUD &amp; DAO)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-23</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p><a href="https://www.wangbo.im/posts/jooq-usecases-code-generating/">JOOQ 的使用 - 代码生成配置 (PostgreSQL &amp; DDL Driven)</a> 介绍了使用 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 为数据库表生成实体类代码；本篇主要介绍基于生成的关系型实体的 CRUD 和 DAO 实践。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-basic-orm&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-sql-executor&#x2F;">JOOQ 的使用 - 从生成代码执行 SQL 命令 (SQL Executor)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-23</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p><a href="https://www.wangbo.im/posts/jooq-usecases-code-generating/">JOOQ 的使用 - 代码生成配置 (PostgreSQL &amp; DDL Driven)</a> 介绍了使用 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 为数据库表生成实体类代码；<a href="https://www.wangbo.im/posts/jooq-usecases-sql-executor/">JOOQ 的使用 - 执行 SQL 语句 (SQL Executor)</a> 介绍了基于 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的 SQL 命令执行；作为对比，本篇主要介绍基于生成代码的 SQL 命令执行 (SQL Executor) 。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-sql-executor&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-sql-builder&#x2F;">JOOQ 的使用 - 从生成代码拼接 SQL 语句 (SQL Builder)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-23</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p><a href="https://www.wangbo.im/posts/jooq-usecases-code-generating/">JOOQ 的使用 - 代码生成配置 (PostgreSQL &amp; DDL Driven)</a> 介绍了使用 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 为数据库表生成实体类代码；<a href="https://www.wangbo.im/posts/jooq-usecases-sql-builder/">JOOQ 的使用 - 拼接 SQL 语句 (SQL Builder)</a> 介绍了基于 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的 SQL 语句拼接；作为对比，本篇主要介绍基于生成代码的 SQL 语句拼接 (SQL Builder) 。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generated-sql-builder&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generating&#x2F;">JOOQ 的使用 - 代码生成配置 (PostgreSQL &amp; DDL Driven)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-21</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的一个最主要的特性就是基于代码生成的类型安全 SQL。其主要是从已有的数据库配置信息中收集
到足够的表结构、字段结构和索引等信息，生成对应的 Java 类型；业务使用生成的 Java 类型来进行 SQL 操作
，可以得到足够的类型安全保证。同时，由于代码生成避免了基于反射的对象关系映射，在调试时会有更好的表现
。</p>
<p>截止到版本 <code>3.12.1</code>, <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 支持从以下数据库配置源生成代码：</p>
<ol>
<li>关系数据库实例，包括(注：免费版本的 jOOQ 可能不支持特定的数据库提供商的产品)：
<ul>
<li>Aurora MySQL Edition</li>
<li>Aurora PostgreSQL Edition</li>
<li>Azure SQL Data Warehouse</li>
<li>Azure SQL Database</li>
<li>CUBRID</li>
<li>DB2 LUW</li>
<li>Derby</li>
<li>Firebird</li>
<li>H2</li>
<li>HANA</li>
<li>HSQLDB</li>
<li>Informix</li>
<li>Ingres</li>
<li>MariaDB</li>
<li>Microsoft Access</li>
<li>MySQL</li>
<li>Oracle</li>
<li>PostgreSQL</li>
<li>Redshift</li>
<li>SQL Server</li>
<li>SQLite</li>
<li>Sybase Adaptive Server Enterprise</li>
<li>Sybase SQL Anywhere</li>
<li>Teradata</li>
<li>Vertica</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Java_Persistence_API">Java Persistence API (JPA)</a> 相关的实体类型（带注解）</li>
<li>符合约定条件的描述表结构信息等的 XML 文件</li>
<li>符合标准的用于创建表结构等的 SQL DDL 语句文件</li>
</ol>
<p>本篇主要介绍基于 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的数据库实例和 SQL DDL 文件驱动的代码生成实践。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-code-generating&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-sql-executor&#x2F;">JOOQ 的使用 - 执行 SQL 语句 (SQL Executor)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-17</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p>本篇主要介绍基于 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的 SQL 命令执行 (SQL Executor) 。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-sql-executor&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-sql-builder&#x2F;">JOOQ 的使用 - 拼接 SQL 语句 (SQL Builder)</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-17</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 是基于 JDBC 之上的一个抽象层，提供了多种多样的模型来与关系型数据库进行互操作；其使用与 <a href="https://mybatis.org/mybatis-3/">mybatis</a> 和 <a href="http://hibernate.org/orm/">Hibernate ORM</a> 不同的思路来实现 <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">对象关系映射 ORM</a> 。</p>
<p>本篇主要介绍基于 <a href="https://www.jooq.org/" title="jOOQ generates Java code from your database and lets you build type safe SQL queries through its fluent API.">jOOQ</a> 的 SQL 语句拼接 (SQL Builder) 。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;jooq-usecases-sql-builder&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;mapstruct-usecases&#x2F;">Mapper Classes Generated by MapStruct</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-10-16</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p>对象实体转换操作在分层应用中很常见，比如数据库层的对象实体和表现层的实体很可能具有不同的属性集，需要在互操作时进行属性的映射（或拷贝）。</p>
<p><a href="https://mapstruct.org/" title="Java bean mappings, the easy way!">MapStruct</a> 是一个辅助进行 Java 实体类之间相互转换的类库，与其他具有相似功能的工具库之间的最大区别在于其使用了 <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">Java 注解处理器 APT</a> 来实现实体间属性的映射而不是使用反射技术。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;mapstruct-usecases&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;add-supports-for-apt-in-maven&#x2F;">在 Maven 中支持 Java 的注解处理器 APT</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-30</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p>Java 中有很多基于 <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">注解处理器 (Annotation Processing Tool, APT)</a> 技术的类库，如 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 和 <a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 等。</p>
<p>在 <a href="https://maven.apache.org/">Maven</a> 中支持 <a href="https://www.wangbo.im/posts/add-supports-for-apt-in-maven/apt">APT</a> ，需要在 <a href="https://maven.apache.org/plugins/maven-compiler-plugin/">Apache Maven Compiler Plugin</a> 的配置部分添加 <a href="https://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#annotationProcessorPaths">annotationProcessorPaths</a> 的配置，如下：</p>
<pre style="background-color:#282828;">
<span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">plugin</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">org.apache.maven.plugins</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">maven-compiler-plugin</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">3.6.1</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">configuration</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">source</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">1.8</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">source</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">target</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">1.8</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">target</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">testSource</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">1.8</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">testSource</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">testTarget</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">1.8</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">testTarget</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">encoding</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">UTF-8</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">encoding</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">optimize</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">true</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">optimize</span><span style="color:#83a598;">&gt;
		</span><span style="font-style:italic;color:#928374;">&lt;!-- Slightly faster builds, see https://issues.apache.org/jira/browse/MCOMPILER-209 --&gt;
		</span><span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">useIncrementalCompilation</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">false</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">useIncrementalCompilation</span><span style="color:#83a598;">&gt;
		&lt;</span><span style="font-weight:bold;color:#8ec07c;">annotationProcessorPaths</span><span style="color:#83a598;">&gt;
			&lt;</span><span style="font-weight:bold;color:#8ec07c;">path</span><span style="color:#83a598;">&gt;
				&lt;</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">com.google.auto.value</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;
				&lt;</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">auto-value</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;
				&lt;</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">${auto-value.version}</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;
			&lt;/</span><span style="font-weight:bold;color:#8ec07c;">path</span><span style="color:#83a598;">&gt;
		&lt;/</span><span style="font-weight:bold;color:#8ec07c;">annotationProcessorPaths</span><span style="color:#83a598;">&gt;
	&lt;/</span><span style="font-weight:bold;color:#8ec07c;">configuration</span><span style="color:#83a598;">&gt;
&lt;/</span><span style="font-weight:bold;color:#8ec07c;">plugin</span><span style="color:#83a598;">&gt;
</span></pre>
<p>上述配置对于 <a href="https://maven.apache.org/">Maven</a> <code>3.5</code> 以上版本有效。</p>
<p>对于低于 <code>3.5</code> 的版本，可以在 <code>dependencies</code> 块中添加依赖项，并设置 <code>optional</code> 属性。</p>
<pre style="background-color:#282828;">
<span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">org.inferred</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">freebuilder</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">${freebuilder_version}</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">optional</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">true</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">optional</span><span style="color:#83a598;">&gt;
&lt;/</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
</span></pre>
<p>如果是可执行的工程，也可以设置 <code>scope</code> 为 <code>provided</code> 。</p>
<pre style="background-color:#282828;">
<span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">org.inferred</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">freebuilder</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">${freebuilder_version}</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;
	&lt;</span><span style="font-weight:bold;color:#8ec07c;">scope</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">provided</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">scope</span><span style="color:#83a598;">&gt;
&lt;/</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
</span></pre>
                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;add-supports-for-apt-in-maven&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;freebuilder-usecases&#x2F;">Value Class Generated by FreeBuilder</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-30</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 是一个非常好用的基于 JAVA <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">注解处理器 APT (Annotation Processing Tool)</a> 技术的数据实体类生成器，可以
通过简单的注解来生成 Builder 模式的实体类。<a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 是另一个非常好用的基于 <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">APT</a> 的类库，参见 <a href="https://www.wangbo.im/posts/google-autovalue-usecases/">Value Class Generated by Google AutoValue</a>。二者的区别在于：</p>
<ol>
<li><a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 根据开发者提供的一个 Builder 接口来实现具体的 Builder 类；<a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 则对给定的数据实体类生成符合固定规则的 Builder 类。前者可以控制生成的 Builder 类的方法列表，后者无法控制生成的 Builder 类的方法列表，但是可以通过继承生成的 Builder 类限制对外暴露的方法列表。</li>
<li><a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 需要数据实体类是一个抽象类；<a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 则同时支持抽象类和接口。</li>
</ol>
<p>详细对比可以参考 <a href="https://github.com/inferred/FreeBuilder#alternatives">FreeBuilder
Alternatives</a> 。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;freebuilder-usecases&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;google-autovalue-usecases&#x2F;">Value Class Generated by Google AutoValue</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-28</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p>Java 中组织数据对象的方式中，最简单也是最通用的是所谓的 POJO (Plain Ordinary Java Object) 即
Java 简单对象。POJO 大法好，好就好在简单实用：只需用遵循简单的命名约定和构造规则，就可以满足数据实体
的需求，而且大多数的序列化方案和持久化方案都能提供 POJO 的支持；如果追求代码精简的话，使用 POJO 可以
和反射方案一起极大地简化重复代码。</p>
<p>POJO 的好处吾等皆非常清楚，然而本文却在讲 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a>，因为：</p>
<ol>
<li>人是善变的。吾等吃够了鸡蛋牛奶，也会想要尝尝豆浆油条。</li>
<li><code>equals</code> <code>toString</code> <code>hash</code> 。此三种样板代码，即使是有 IDE 的协助，维护起来仍会非常痛苦。</li>
<li><a href="http://www.dalnefre.com/wp/2011/11/high-availability-for-mutable-shared-state/comment-page-1/">Mutable shared state is the root of all evil in concurrent
systems</a>
。可变性在并发系统中的共享是所有 BUG 的源头，不可变性是救赎之道；而 POJO 不能满足不可变性约束。</li>
<li>Google 大法好。<a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 是 Google Java 团队的作品。</li>
</ol>
<p><a href="https://www.wangbo.im/posts/google-autovalue-usecases/autovalue">AutoValue</a> 是一个基于 Java <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">注解处理器 APT
(Annotation Processing Tool)</a> 的代码生成库，网络上关于 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 的介绍不要太少，毋庸再讲；其理念和实际用法可见
<a href="https://github.com/google/auto/blob/master/value/userguide/index.md">官网文档</a>，十分钟入门，老少咸
宜。</p>
<p>本文对于 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 的用法做一个简单汇总，并引申介绍一下基于 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 的对
象 JSON 序列化方案。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;google-autovalue-usecases&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;spring-cloud-gateway-load-testing-using-wrk&#x2F;">Spring Cloud Gateway Load Testing using Wrk</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-17</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://spring.io/projects/spring-cloud-gateway" title="Spring Cloud Gateway">Spring Cloud Gateway</a> 是 <a href="https://spring.io/" title="Spring">Spring</a> 官方为了完善 <a href="https://spring.io/projects/spring-cloud" title="Spring Cloud">Spring Cloud</a> 的版图
而推出的网关服务组件，使用了非阻塞式网络模式和目前流行的响应式编程模型，吸引了很多公司和开发者的注意
力。</p>
<p>网络上有一些现成的对 <a href="https://spring.io/projects/spring-cloud-gateway" title="Spring Cloud Gateway">Spring Cloud Gateway</a> 的性能测试的案例，比如 <a href="https://www.jianshu.com/p/a19e24a6a747">纠错帖：Zuul &amp; Spring Cloud Gateway &amp; Linkerd性能对比</a>。根据 <a href="https://github.com/spencergibb/spring-cloud-gateway-bench">Simple benchmark comparing zuul and spring cloud gateway </a> 的数据，<a href="https://spring.io/projects/spring-cloud-gateway" title="Spring Cloud Gateway">Spring Cloud Gateway</a> 的性能测试结果参考如下：</p>
<table><thead><tr><th>Proxy</th><th>Avg Latency</th><th>Avg Req/Sec/Thread</th></tr></thead><tbody>
<tr><td>gateway</td><td>6.61ms</td><td>3.24k</td></tr>
<tr><td>linkered</td><td>7.62ms</td><td>2.82k</td></tr>
<tr><td>zuul</td><td>12.56ms</td><td>2.09k</td></tr>
<tr><td>none</td><td>2.09ms</td><td>11.77k</td></tr>
</tbody></table>
<p>但是，由于：</p>
<ol>
<li>上述测试只是简单的对后端反向代理测试，而我们知道 <a href="https://spring.io/projects/spring-cloud-gateway" title="Spring Cloud Gateway">Spring Cloud Gateway</a> 对于路由的匹配是顺序的，匹配链后面的路由的性能并没有被关注到。</li>
<li>测试数据被进行了简化，测试的细节被（有意地）忽略了。</li>
</ol>
<p>所以，在根据 <a href="https://spring.io/projects/spring-cloud-gateway" title="Spring Cloud Gateway">Spring Cloud Gateway</a> 改造出了初版的公司网关系统之后，我使用 <a href="https://github.com/wg/wrk" title="Modern HTTP benchmarking tool">wrk</a> 和 <a href="https://github.com/giltene/wrk2" title="A constant throughput, correct latency recording variant of wrk">wrk2</a> 对网关进行了多轮的压测，测试结果汇总为本文。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;spring-cloud-gateway-load-testing-using-wrk&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;usage-of-benchmarking-tool-wrk-and-wrk2&#x2F;">Usage of Benchmarking Tool WRK and WRK2</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-17</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p><a href="https://github.com/wg/wrk" title="Modern HTTP benchmarking tool">wrk</a> 是一款短小精悍又备受赞誉的开源性能测试工具，能够用来对 HTTP 服务进行压测；<a href="https://github.com/giltene/wrk2" title="A constant throughput, correct latency recording variant of wrk">wrk2</a> 是
对 <a href="https://github.com/wg/wrk" title="Modern HTTP benchmarking tool">wrk</a> 的改进，增加了压测结果的直方图输出。</p>
<p>网路上有不少介绍 <a href="https://github.com/wg/wrk" title="Modern HTTP benchmarking tool">wrk</a> 或 <a href="https://github.com/giltene/wrk2" title="A constant throughput, correct latency recording variant of wrk">wrk2</a> 的文章，但大多泛泛而谈，对于压测的结果输出项的解释也是云
里雾里或者简单跳过，殊为遗憾。</p>
<p>本文主要介绍 <a href="https://github.com/wg/wrk" title="Modern HTTP benchmarking tool">wrk</a> 和 <a href="https://github.com/giltene/wrk2" title="A constant throughput, correct latency recording variant of wrk">wrk2</a> 的使用，并在阅读源码的基础上对输出结果的项进行解释。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;usage-of-benchmarking-tool-wrk-and-wrk2&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                                <article class="post">
                                    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;vboxmanage-note-change-host-key-for-vboxsdl&#x2F;">Change Host Key for VBOXSDL</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-12</span>
            
        </div>
    </header>

                                    <div class="post__summary">
                                        <p>如果平时使用 Linux，偶尔会有使用 Windows 软件（如 WPS/QQ 等）的需求场景时，最好的解决方案就是使用虚拟机了。如果使用了 <a href="https://www.virtualbox.org/">Virtual Box</a> 的话，那么可以了解一下其除了基于 <a href="https://www.qt.io/">Qt</a> 的虚拟机运行界面之外还额外提供了一个基于 <a href="https://www.libsdl.org/">SDL</a> 的虚拟机运行界面。</p>
<p>我在使用 virtualbox 的管理界面创建配置好一个基于 Windows 7 的虚拟机 &quot;se7en&quot; 之后，可以直接在终端运行：</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1;">${VBOXSDL} --startvm se7en
</span></pre>
<p>界面非常简洁，不依赖 <a href="https://www.qt.io/">Qt</a> 。</p>
<p><code>${VBOXSDL}</code> 是 vboxsdl 的可执行文件名；根据 VirtualBox 的安装方式不同，可能会是 &quot;VBoxSDL&quot; 或 &quot;vboxsdl&quot;。</p>
<p>如果需要修改 SDL 界面下的 host 键，可以使用参数 &quot;--hostkey&quot;。</p>
<pre style="background-color:#282828;">
<span style="font-style:italic;color:#928374;"># Set Host key for vboxsdl
# LSHIFT = 304 1
# RSHIFT = 303 2
# LCTRL = 301 8192
# RCTRL = 305 128
# LALT = 308 256
# RALT = 27 0
</span><span style="color:#fdf4c1;">${VBOXSDL} --hostkey 308 256 --startvm se7en
</span></pre>
<p>该命令会设置 host 键为 左-Alt 键并启动虚拟机。</p>

                                    </div>
                                    <div class="read-more">
                                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;vboxmanage-note-change-host-key-for-vboxsdl&#x2F;">Read more...</a>
                                    </div>
                                </article>
                            
                        </div>
                        <nav class="pagination">
                            
                            
                                <a class="next" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;page&#x2F;2&#x2F;">Next ›</a>
                            
                        </nav>
                    
                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;even.js" ></script>
      
    </body>

</html>
