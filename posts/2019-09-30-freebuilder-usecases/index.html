

<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>wangbo’s blog - Value Class Generated by FreeBuilder</title>

      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
      

      
          <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;site.css">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">WB Prime</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;tags">
                            Tags
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;github.wangbo.im">
                            Github
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https://www.wangbo.im&#x2F;about">
                            About
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;www.wangbo.im">WB Prime</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;tags">
                                    Tags
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;github.wangbo.im">
                                    Github
                                </a>
                            </li>
                        
                            <li>
                                <a href="https://www.wangbo.im&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    



<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2019-09-30-freebuilder-usecases&#x2F;">Value Class Generated by FreeBuilder</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2019-09-30</span>
            
        </div>
    </header>

    <div class="post-content">
      <p><a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 是一个非常好用的基于 JAVA <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">注解处理器 APT (Annotation Processing Tool)</a> 技术的数据实体类生成器，可以
通过简单的注解来生成 Builder 模式的实体类。<a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 是另一个非常好用的基于 <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">APT</a> 的类库，参见 <a href="@/posts/2019-09-28-google-autovalue-usecases/index.md">Value Class Generated by Google AutoValue</a>。二者的区别在于：</p>
<ol>
<li><a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 根据开发者提供的一个 Builder 接口来实现具体的 Builder 类；<a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 则对给定的数据实体类生成符合固定规则的 Builder 类。前者可以控制生成的 Builder 类的方法列表，后者无法控制生成的 Builder 类的方法列表，但是可以通过继承生成的 Builder 类限制对外暴露的方法列表。</li>
<li><a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 需要数据实体类是一个抽象类；<a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 则同时支持抽象类和接口。</li>
</ol>
<p>详细对比可以参考 <a href="https://github.com/inferred/FreeBuilder#alternatives">FreeBuilder
Alternatives</a> 。</p>
<p><a name="continue-reading"></a></p>
<h1 id="maven-settings"><a class="zola-anchor" href="#maven-settings" aria-label="Anchor link for: maven-settings">🔗</a>
Maven Settings</h1>
<pre style="background-color:#282828;">
<span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">org.inferred</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">groupId</span><span style="color:#83a598;">&gt;
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">freebuilder</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">artifactId</span><span style="color:#83a598;">&gt;
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">${freebuilder_version}</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">version</span><span style="color:#83a598;">&gt;
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#83a598;">&lt;</span><span style="font-weight:bold;color:#8ec07c;">scope</span><span style="color:#83a598;">&gt;</span><span style="color:#fdf4c1aa;">provided</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">scope</span><span style="color:#83a598;">&gt;
</span><span style="color:#83a598;">&lt;/</span><span style="font-weight:bold;color:#8ec07c;">dependency</span><span style="color:#83a598;">&gt;
</span></pre>
<p><code>freebuilder</code> 中同时包含了定义数据实体类时需要的注解和注解处理器实现。</p>
<p>截至 2019-09-30 日， <a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 的最新版本是 <code>2.4.1</code> 。</p>
<h1 id="abstract-class"><a class="zola-anchor" href="#abstract-class" aria-label="Anchor link for: abstract-class">🔗</a>
Abstract Class</h1>
<p>一个基本的数据类如下：</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">@</span><span style="color:#fdf4c1;">FreeBuilder
</span><span style="color:#fa5c4b;">interface </span><span style="color:#8ec07c;">Task </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#8ec07c;">Long id</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#8ec07c;">String type</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#8ec07c;">String description</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">static </span><span style="color:#8ec07c;">Builder builder</span><span style="color:#fdf4c1aa;">() { </span><span style="color:#fa5c4b;">return new </span><span style="color:#8ec07c;">Builder</span><span style="color:#fdf4c1aa;">(); }
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">class </span><span style="color:#8ec07c;">Builder </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">Task_Builder </span><span style="color:#fdf4c1aa;">{ }
</span><span style="color:#fdf4c1aa;">}
</span></pre>
<p>上述是所需要的全部代码。如果倾向于使用抽象类的话，可以换成：</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">@</span><span style="color:#fdf4c1;">FreeBuilder
</span><span style="color:#fa5c4b;">abstract class </span><span style="color:#8ec07c;">Task </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">abstract long </span><span style="color:#8ec07c;">getId</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">abstract </span><span style="color:#8ec07c;">String getType</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">abstract </span><span style="color:#8ec07c;">String getDescription</span><span style="color:#fdf4c1aa;">();
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">static </span><span style="color:#8ec07c;">Builder builder</span><span style="color:#fdf4c1aa;">() { </span><span style="color:#fa5c4b;">return new </span><span style="color:#8ec07c;">Builder</span><span style="color:#fdf4c1aa;">(); }
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">static class </span><span style="color:#8ec07c;">Builder </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">Task_Builder </span><span style="color:#fdf4c1aa;">{ }
</span><span style="color:#fdf4c1aa;">}
</span></pre>
<p>定义一个数据实体类，只需提供一个接口或抽象类，所需字段以接口方法/抽象方法声明即可，<a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 会通过 <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/apt/" title="Annotation Processing Tool (apt)">APT</a> 生成一个名为 <code>Task_Builder</code> 的 Builder 类和两个分别名为 <code>Task_Builder.Value</code> 和 <code>Task_Builder.Partial</code> 的实现类。以上生成类的类名是由实体类名自动生成的。</p>
<p>每一个接口方法/抽象方法会被 <a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 标记为一个 <em>property</em> ：如果方法名以 &quot;get&quot; 开头则对应的 <em>property</em> 名是方法名去掉 &quot;get&quot; 之后的部分，否则是整个方法名。</p>
<h1 id="builder"><a class="zola-anchor" href="#builder" aria-label="Anchor link for: builder">🔗</a>
Builder</h1>
<p><a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 会在 <code>Task_Builder</code> 中为 <code>Task</code> 中的每一个 <em>property</em> 生成一系列的方法。</p>
<h2 id="regular-property"><a class="zola-anchor" href="#regular-property" aria-label="Anchor link for: regular-property">🔗</a>
Regular Property</h2>
<p>对于基本类型和普通类类型的 <em>property</em> 如 <code>long getId()</code>，会生成：</p>
<table><thead><tr><th> 方法                       </th><th> 说明    </th></tr></thead><tbody>
<tr><td> setId(long)                </td><td> Setter  </td></tr>
<tr><td> getId()                    </td><td> Getter  </td></tr>
<tr><td> mapId(UnaryOperator<Long>) </td><td> Mutator </td></tr>
</tbody></table>
<p>示例如下：</p>
<pre style="background-color:#282828;">
<span style="color:#fdf4c1aa;">@</span><span style="color:#fdf4c1;">Generated</span><span style="color:#fdf4c1aa;">(</span><span style="color:#b8bb26;">&quot;org.inferred.freebuilder.processor.Processor&quot;</span><span style="color:#fdf4c1aa;">)
</span><span style="color:#fa5c4b;">abstract class </span><span style="color:#8ec07c;">Task_Builder </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">Task</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder setId</span><span style="color:#fdf4c1aa;">(</span><span style="color:#fa5c4b;">long </span><span style="color:#fdf4c1;">id</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">        </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">Task</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder mapId</span><span style="color:#fdf4c1aa;">(</span><span style="color:#8ec07c;">UnaryOperator</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">Long</span><span style="color:#fdf4c1aa;">&gt; </span><span style="color:#fdf4c1;">mapper</span><span style="color:#fdf4c1aa;">) {
</span><span style="color:#fdf4c1aa;">        </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fa5c4b;">public long </span><span style="color:#8ec07c;">getId</span><span style="color:#fdf4c1aa;">() {
</span><span style="color:#fdf4c1aa;">        </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">    </span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span></pre><h2 id="property-of-optional-type"><a class="zola-anchor" href="#property-of-optional-type" aria-label="Anchor link for: property-of-optional-type">🔗</a>
Property of Optional Type</h2>
<p>对于 <code>Optional</code> (<code>java.util.Optional</code> 或 <code>com.google.common.base.Optional</code>) 类型的 <em>property</em> 如 <code>Optional&lt;String&gt; getTitle()</code>，会生成：</p>
<table><thead><tr><th> 方法                          </th><th> 说明                           </th></tr></thead><tbody>
<tr><td> setTitle(String)              </td><td> Setter with non-null value     </td></tr>
<tr><td> setTitle(Optional<String>)    </td><td> Setter with optional value     </td></tr>
<tr><td> setNullableTitle(String)      </td><td> Setter with nullable value     </td></tr>
<tr><td> getTitle()                    </td><td> Getter                         </td></tr>
<tr><td> mapTitle(Spliterator<String>) </td><td> Mutator                        </td></tr>
<tr><td> clearTitle()                  </td><td> Setter with <code>Optional.empty()</code> </td></tr>
</tbody></table>
<p>示例如下：</p>
<pre style="background-color:#282828;">
<span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">setTitle(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;"> title) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">setTitle(</span><span style="color:#8ec07c;">Optional</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">&gt; title) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">setNullableTitle(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;"> title) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">mapTitle(</span><span style="color:#8ec07c;">UnaryOperator</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">&gt; mapper) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">clearTitle() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">Optional</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">&gt; </span><span style="color:#fdf4c1;">getTitle() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span></pre><h2 id="property-of-collection-type"><a class="zola-anchor" href="#property-of-collection-type" aria-label="Anchor link for: property-of-collection-type">🔗</a>
Property of Collection Type</h2>
<p>对于 <code>List</code>, <code>Set</code>, <code>SortedSet</code> 和 <code>Multiset</code> 类型的 <em>property</em> 如 <code>List&lt;String&gt; getEmails()</code> ，会生成：</p>
<table><thead><tr><th> 方法                                 </th><th> 说明                                                       </th></tr></thead><tbody>
<tr><td> addEmails(String)                    </td><td> Appends a single value                                     </td></tr>
<tr><td> addEmails(String ...)                </td><td> Appends multi values                                       </td></tr>
<tr><td> addAllEmails(Iterable<String>)       </td><td> Appends all elements from a <code>java.lang.Iterable</code>           </td></tr>
<tr><td> addAllEmails(Spliterator<String>)    </td><td> Appends all elements from a <code>java.util.Spliterator</code>        </td></tr>
<tr><td> addAllEmails(Stream<String>)         </td><td> Appends all elements from a <code>java.util.stream.Stream</code>      </td></tr>
<tr><td> mutateEmails(Consumer&lt;List<String>&gt;) </td><td> Mutates values by invoking a <code>java.util.function.Consumer</code> </td></tr>
<tr><td> clearEmails()                        </td><td> Remove all elements                                        </td></tr>
<tr><td> getEmails()                          </td><td> Returns an unmodifiable view of all elements               </td></tr>
</tbody></table>
<p>示例如下：</p>
<pre style="background-color:#282828;">
<span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">addEmails(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;"> element) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">addEmails(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">... elements) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">addAllEmails(</span><span style="color:#8ec07c;">Spliterator</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">&gt; elements) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">addAllEmails(</span><span style="color:#8ec07c;">BaseStream</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">, </span><span style="color:#fe8019;">?</span><span style="color:#fdf4c1;">&gt; elements) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">addAllEmails(</span><span style="color:#8ec07c;">Iterable</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">&gt; elements) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">mutateEmails(</span><span style="color:#8ec07c;">Consumer</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">super </span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">&gt;&gt; mutator) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">clearEmails() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">List</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">&gt; </span><span style="color:#fdf4c1;">getEmails() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span></pre><h2 id="property-of-map-type"><a class="zola-anchor" href="#property-of-map-type" aria-label="Anchor link for: property-of-map-type">🔗</a>
Property of Map Type</h2>
<p>对于 <code>Map</code> 类型的 <em>property</em> 如 <code>Map&lt;String, Integer&gt; getScores()</code>，会生成：</p>
<table><thead><tr><th> 方法                                         </th><th> 说明                                      </th></tr></thead><tbody>
<tr><td> putScores(String, Integer)                   </td><td> Adds a key-value pair                     </td></tr>
<tr><td> putAllScores(Map&lt;String, Integer&gt;)           </td><td> Adds key-value pairs from an existed map  </td></tr>
<tr><td> removeScores(String)                         </td><td> Removes a pair with given key             </td></tr>
<tr><td> mutateScores(Consumer&lt;Map&lt;String, Integer&gt;&gt;) </td><td> Mutator                                   </td></tr>
<tr><td> clearScores()                                </td><td> Removes all pairs                         </td></tr>
<tr><td> getScores()                                  </td><td> Returns an unmodifiable view of all pairs </td></tr>
</tbody></table>
<p>示例如下：</p>
<pre style="background-color:#282828;">
<span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">putScores(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;"> key, </span><span style="color:#fa5c4b;">int</span><span style="color:#fdf4c1;"> value) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">putAllScores(</span><span style="color:#8ec07c;">Map</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">, </span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">extends </span><span style="color:#8ec07c;">Integer</span><span style="color:#fdf4c1;">&gt; map) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">removeScores(</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;"> key) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">mutateScores(</span><span style="color:#8ec07c;">Consumer</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#fe8019;">? </span><span style="color:#fa5c4b;">super </span><span style="color:#8ec07c;">Map</span><span style="color:#fdf4c1;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1;">, </span><span style="color:#8ec07c;">Integer</span><span style="color:#fdf4c1;">&gt;&gt; mutator) </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">StudentDto</span><span style="color:#fdf4c1aa;">.</span><span style="color:#8ec07c;">Builder </span><span style="color:#fdf4c1;">clearScores() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span><span style="color:#fdf4c1aa;">
</span><span style="color:#fa5c4b;">public </span><span style="color:#8ec07c;">Map</span><span style="color:#fdf4c1aa;">&lt;</span><span style="color:#8ec07c;">String</span><span style="color:#fdf4c1aa;">, </span><span style="color:#8ec07c;">Integer</span><span style="color:#fdf4c1aa;">&gt; </span><span style="color:#fdf4c1;">getScores() </span><span style="color:#fdf4c1aa;">{
</span><span style="color:#fdf4c1aa;">    </span><span style="font-style:italic;color:#928374;">// ...
</span><span style="color:#fdf4c1aa;">}
</span></pre><h2 id="custom-propertys-generation"><a class="zola-anchor" href="#custom-propertys-generation" aria-label="Anchor link for: custom-propertys-generation">🔗</a>
Custom Propertys Generation</h2>
<p><a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 会自动生成数据实体类的 <code>String toString()</code> 方法和 <code>boolean equals(Object)</code>；方法实现中会默认包含所有的 <em>property</em> 。</p>
<p>如果某个 <em>property</em> 不想被包含在 <code>toString</code> 方法中，可以对其添加 <code>@NotInToString</code> 注解。</p>
<p>如果某个 <em>property</em> 不想被包含在 <code>equals</code> 方法中，可以对其添加 <code>@IgnoredByEquals</code> 注解。</p>
<hr />
<p>完整的示例代码可以参见 <a href="https://github.com/wbprime/java-mods/tree/master/freebuilder-usecases">FreeBuilder Usecases</a> 。</p>
<hr />
<p><a href="https://freebuilder.inferred.org/" title="Automatic generation of the Builder pattern for Java">FreeBuilder</a> 是这样的强大，以至于我正在使用它逐步替换 <a href="https://github.com/google/auto/tree/master/value" title="AutoValue - Immutable value-type code generation for Java 1.6+.">AutoValue</a> 。</p>
<p>以上。</p>

    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;java&#x2F;">#java</a>
                    
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;apt&#x2F;">#apt</a>
                    
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;freebuilder&#x2F;">#freebuilder</a>
                    
                </div>
            
            
                <div class="post-nav">
                    
                        <a class="previous" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2019-09-28-google-autovalue-usecases&#x2F;">‹ Value Class Generated by Google AutoValue</a>
                    
                    
                        <a class="next" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2019-09-30-add-supports-for-apt-in-maven&#x2F;">在 Maven 中支持 Java 的注解处理器 APT ›</a>
                    
                    
                    
                </div>
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;even.js" ></script>
      
    </body>

</html>
