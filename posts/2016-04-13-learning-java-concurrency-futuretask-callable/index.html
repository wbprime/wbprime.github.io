<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Learning Java Concurrency - FutureTask &amp; Callable - Elvis Wang</title>
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="wangboâ€™s home &amp; blog"/>

    <meta property="og:title" content="
    wangboâ€™s blog -&nbsp;Learning Java Concurrency - FutureTask &amp; Callable" />
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-13-learning-java-concurrency-futuretask-callable&#x2F;"/>
    <meta property="og:description" content="&lt;p&gt;Javaçš„&lt;code&gt;java.util.concurrent&lt;&#x2F;code&gt;åŒ…é‡Œé¢æä¾›äº†å¤šçº¿ç¨‹å¹¶å‘å’ŒåŒæ­¥çš„æ”¯æŒã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå¤šçº¿ç¨‹è¢«è®¤ä¸ºæ˜¯æ‰§è¡Œä»»åŠ¡çš„æ‰‹æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»£ç ï¼Œè‡³äºèµ„æºå…±äº«ã€çº¿ç¨‹åŒæ­¥ç­‰å¯ä»¥ç”¨é”ã€åŒæ­¥å™¨ç­‰è§£å†³ã€‚æ‰€ä»¥&lt;code&gt;Thread&lt;&#x2â€¦"/>
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;style.css">
    <link rel="stylesheet" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;color&#x2F;blue.css">
<link rel="shortcut icon" href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;favicon.ico" type="image/x-icon" /></head>
    <body>
        <div class="container full">
<header class="header">
    <div class="header__inner">
        <div class="header__logo">
            <a href="&#x2F;">
    <div class="logo">
        WB Prime
    </div>
</a>
        </div>
        <div class="menu-trigger">menu</div>
    </div>
    
    <nav class="menu">
        <ul class="menu__inner menu__inner--desktop">
            
            
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
                    </li>
                
                    <li>
                        <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
                    </li>
                
            </ul>

        <ul class="menu__inner menu__inner--mobile">
            
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;about">About</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories">Categories</a>
        </li>
        <li>
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags">Tags</a>
        </li>
        </ul>
    </nav>

    </header>
<div class="content"><div class="post">
        <h1 class="post-title">
            <a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;posts&#x2F;2016-04-13-learning-java-concurrency-futuretask-callable&#x2F;">Learning Java Concurrency - FutureTask &amp; Callable</a>
        </h1>
        
    <div class="post-meta">
        <span class="post-date">2016.04.13
                </span>

        <span class="post-author"></span>

        

    
    :: {<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;categories&#x2F;learning-java-concurrency&#x2F;">Learning Java Concurrency</a>} 

            
    ::
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;java&#x2F;">java</a>
        
    #<a href="https:&#x2F;&#x2F;www.wangbo.im&#x2F;tags&#x2F;concurrency&#x2F;">concurrency</a>
        
    
            
        
    </div>



        

        <div class="post-content">
            <p>Javaçš„<code>java.util.concurrent</code>åŒ…é‡Œé¢æä¾›äº†å¤šçº¿ç¨‹å¹¶å‘å’ŒåŒæ­¥çš„æ”¯æŒã€‚</p>
<p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå¤šçº¿ç¨‹è¢«è®¤ä¸ºæ˜¯æ‰§è¡Œä»»åŠ¡çš„æ‰‹æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»£ç ï¼Œè‡³äºèµ„æºå…±äº«ã€çº¿ç¨‹åŒæ­¥ç­‰å¯ä»¥ç”¨é”ã€åŒæ­¥å™¨ç­‰è§£å†³ã€‚æ‰€ä»¥<code>Thread</code>ç±»å’Œ<code>Rannable</code>æ¥å£æš´éœ²äº†ä¸€ä¸ª<code>void run()</code>æ–¹æ³•æ¥æä¾›è‡ªå®šä¹‰è¡Œä¸ºã€‚</p>
<p>ä½†æ…¢æ…¢åœ°ï¼Œäººä»¬å¼€å§‹å‘ç°å¦‚æœè‡ªå®šä¹‰çš„çº¿ç¨‹æ˜¯è®¡ç®—ç»“æœçš„ï¼Œé‚£æˆ‘æ€ä¹ˆæ¥æ‹¿åˆ°è®¡ç®—ä¹‹åçš„ç»“æœå‘¢ï¼Ÿå¦å¤–ï¼Œæˆ‘å¾—çŸ¥é“ä»€ä¹ˆæ—¶å€™è®¡ç®—ç»“æŸäº†ï¼Œå¦‚æœè®¡ç®—çš„æ—¶é—´å¤ªé•¿äº†ï¼Œæˆ‘ä¹Ÿæƒ³èƒ½å¤Ÿç»ˆæ­¢è®¡ç®—çº¿ç¨‹çš„æ‰§è¡Œã€‚è¿™äº›éœ€æ±‚å…¶å®ç”¨åŸºæœ¬çš„å¤šçº¿ç¨‹å·¥å…·ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯è¿‡ç¨‹æ¯”è¾ƒç¹çï¼›è€Œä¸”è¿™äº›éœ€æ±‚æœ‰ä¸€æ®µæ—¶é—´åˆç‰¹åˆ«æ™®éã€‚ç»ˆäºï¼Œjdk 1.5å¼€å§‹å¼•å…¥äº†<code>Callable</code>æ¥å£å’Œ<code>Future</code>æ¥å£ï¼Œç”¨äºæ”¯æ´æœ‰è¿”å›å€¼çš„è®¡ç®—ä»»åŠ¡ã€‚</p>
<p><a name="continue-reading"></a></p>
<h1 id="callable"><a class="zola-anchor" href="#callable" aria-label="Anchor link for: callable">ğŸ”—</a>
Callable</h1>
<p><code>Callable</code>æ¥å£å’Œ<code>Runnable</code>æ¥å£å¾ˆæ¥è¿‘ï¼Œæœ‰å¤šæ¥è¿‘å‘¢ï¼Ÿå¯¹æ¯”ä¸€ä¸‹ä»£ç å°±çŸ¥é“äº†ã€‚</p>
<p>è¿™æ˜¯<code>Runnable</code>çš„ä»£ç ï¼š</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public interface </span><span style="color:#dcdcdc;">Runnable {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public abstract void </span><span style="color:#dcdcdc;">run();
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>è¿™æ˜¯<code>Callable</code>çš„æ¥å£ï¼š</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public interface </span><span style="color:#dcdcdc;">Callable&lt;V&gt; {
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">V call() </span><span style="color:#569cd6;">throws </span><span style="color:#dcdcdc;">Exception;
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>Callable</code>æ¥å£æ¯”<code>Runnable</code>æ¥å£å¤šäº†ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼</li>
<li>æ–¹æ³•å¯ä»¥æŠ›å‡ºCheckedå¼‚å¸¸</li>
</ul>
<p>æ·»åŠ è¿”å›å€¼å°±æ˜¯ä¸ºäº†æ”¯æ´è®¡ç®—ç±»çš„ä»»åŠ¡ï¼›å¯ä»¥æŠ›å‡ºCheckedå¼‚å¸¸åˆ™æ˜¯ä¸ºäº†å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p>
<p>Thread/Runnable æœºåˆ¶æ˜¯ä¸å…è®¸æŠ›å‡ºCheckedå¼‚å¸¸çš„ï¼›å¦‚æœæŠ›å‡ºäº†Uncheckedå¼‚å¸¸ï¼Œä¼šè‡ªåŠ¨å»å¯»æ‰¾çº¿ç¨‹çš„å¼‚å¸¸å¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå‚è§ <a href="https://www.wangbo.im/posts/2016-04-11-learning-java-concurrency-thread-runnable/">Learning Java Concurrency - Thread &amp; Runnable</a> é‡Œé¢å…³äºçº¿ç¨‹å¼‚å¸¸å¤„ç†çš„éƒ¨åˆ†ã€‚</p>
<h1 id="future"><a class="zola-anchor" href="#future" aria-label="Anchor link for: future">ğŸ”—</a>
Future</h1>
<p><code>Future</code>æ¥å£å°è£…äº†å¼‚æ­¥è®¡ç®—çš„ç»“æœï¼Œç”¨äºåœ¨å¼‚æ­¥ä»»åŠ¡å®Œæˆä¹‹åè·å–ç»“æœã€‚</p>
<p>æ¥å£çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public interface </span><span style="color:#dcdcdc;">Future&lt;V&gt; {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">boolean </span><span style="color:#dcdcdc;">cancel(</span><span style="color:#569cd6;">boolean </span><span style="color:#dcdcdc;">mayInterruptIfRunning);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">boolean </span><span style="color:#dcdcdc;">isCancelled();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">boolean </span><span style="color:#dcdcdc;">isDone();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">V get() </span><span style="color:#569cd6;">throws </span><span style="color:#dcdcdc;">InterruptedException, ExecutionException;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">V get(</span><span style="color:#569cd6;">long </span><span style="color:#dcdcdc;">timeout, TimeUnit unit)
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">throws </span><span style="color:#dcdcdc;">InterruptedException, ExecutionException, TimeoutException;
</span><span style="color:#dcdcdc;">}
</span></pre>
<p><code>get()</code>æ–¹æ³•ç”¨äºè·å–å¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚å¦‚æœå¼‚æ­¥ä»»åŠ¡è¿˜æ²¡æœ‰ç»“æŸï¼Œè¯¥æ–¹æ³•çš„è°ƒç”¨ä¼šè¢«é˜»å¡ï¼Œä¸€ç›´åˆ°å¼‚æ­¥ä»»åŠ¡è¿è¡Œç»“æŸï¼ˆæ­£å¸¸ç»“æŸæˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œæˆ–è€…å¼‚æ­¥ä»»åŠ¡çº¿ç¨‹è¢«ä¸­æ–­ã€‚å¦‚æœå¼‚æ­¥ä»»åŠ¡çº¿ç¨‹è¢«ä¸­æ–­ï¼Œè¯¥æ–¹æ³•æŠ›å‡º<code>InterruptedException</code>å¼‚å¸¸ï¼›å¦‚æœå¼‚æ­¥ä»»åŠ¡æ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè¯¥æ–¹æ³•æŠ›å‡º<code>ExecutionException</code>å¼‚å¸¸ã€‚</p>
<p><code>get(long, TimeUnit)</code>æ–¹æ³•åŒä¸Šï¼Œæ·»åŠ äº†è¿‡æœŸæ—¶é—´çš„è®¾ç½®ï¼šå½“åœ¨æŒ‡å®šæ—¶é—´å†…å¼‚æ­¥ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œè¯¥æ–¹æ³•æŠ›å‡º<code>TimeoutException</code>å¼‚å¸¸ã€‚</p>
<p>é™¤äº†è·å–å¼‚æ­¥ä»»åŠ¡è®¡ç®—ç»“æœçš„æ–¹æ³•ä¹‹å¤–ï¼Œ<code>Future</code>æ¥å£è¿˜æä¾›äº†åˆ¤æ–­å¼‚æ­¥ä»»åŠ¡çŠ¶æ€çš„æ–¹æ³•å’Œå–æ¶ˆä»»åŠ¡çš„æ–¹æ³•ã€‚</p>
<p><code>isDone()</code>æ–¹æ³•è¿”å›å¼‚æ­¥ä»»åŠ¡æ˜¯å¦ç»“æŸã€‚å¼‚æ­¥ä»»åŠ¡æ­£å¸¸ã€å¼‚å¸¸ç»“æŸï¼Œå¼‚æ­¥ä»»åŠ¡è¢«æ‰‹åŠ¨å–æ¶ˆï¼Œéƒ½è¢«è®¤ä¸ºæ˜¯ç»“æŸï¼ˆDoneï¼‰ã€‚</p>
<p><code>isCancelled()</code>æ–¹æ³•è¿”å›å¼‚æ­¥ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆã€‚</p>
<p><code>cancle(boolean mayInterruptIfRunning)</code>æ–¹æ³•ç”¨äºå–æ¶ˆå¼‚æ­¥ä»»åŠ¡ã€‚é¡¾åæ€ä¹‰ï¼Œå¦‚æœå¼‚æ­¥ä»»åŠ¡å·²ç»è¿è¡Œå®Œæ¯•äº†ï¼Œå½“ç„¶æ²¡æ³•å†å–æ¶ˆäº†ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›å¤±è´¥ï¼›åŒç†ï¼Œä¸€ä¸ªå·²ç»è¢«å–æ¶ˆäº†çš„å¼‚æ­¥ä»»åŠ¡ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¼šè¿”å›å¤±è´¥ã€‚å¯¹äºæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè¯¥æ–¹æ³•ä¼šæ ¹æ®<code>mayInterruptIfRunning</code>å‚æ•°çš„å€¼å»åˆ¤æ–­æ˜¯å¦éœ€è¦ä¸­æ–­å¼‚æ­¥çº¿ç¨‹ã€‚å¯¹äºæœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¹‹åï¼Œä»»åŠ¡æ°¸è¿œä¸ä¼šå†è¿è¡Œã€‚</p>
<h1 id="callable-future-de-shi-yong"><a class="zola-anchor" href="#callable-future-de-shi-yong" aria-label="Anchor link for: callable-future-de-shi-yong">ğŸ”—</a>
Callable & Future çš„ä½¿ç”¨</h1>
<p>å› ä¸º<code>Thread</code>ç±»å¹¶ä¸æ”¯æŒç›´æ¥ä½¿ç”¨<code>Callable</code>æ¥å£ï¼Œæ‰€ä»¥JUCåœ¨<code>ExecutorService</code>æ¡†æ¶ä¸­æä¾›äº†ä½¿ç”¨<code>Callable</code>å’Œ<code>Future</code>çš„å…¥å£ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#dcdcdc;">&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task);
</span></pre>
<p>ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼šè‡ªå®šä¹‰ä¸€ä¸ª<code>Callable</code>æ¥å£çš„å®ç°ï¼Œç„¶åæäº¤ç»™<code>ExecutorService</code>å®ä¾‹ï¼Œç„¶åè°ƒç”¨<code>Future.get()</code>ç­‰å¾…å¼‚æ­¥ä»»åŠ¡è¿è¡Œç»“æŸå¹¶è·å–ç»“æœå°±å¥½äº†ã€‚å½“ç„¶ï¼Œå¦‚æœä»»åŠ¡è¿è¡ŒæœŸé—´ç­‰ä¸åŠçš„è¯ï¼Œä¹Ÿå¯ä»¥å–æ¶ˆä»»åŠ¡ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public class </span><span style="color:#dcdcdc;">CallableFutureCase {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">SumupTask </span><span style="color:#569cd6;">implements </span><span style="color:#4ec9b0;">Callable</span><span style="color:#dcdcdc;">&lt;Long&gt; {
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">private final int </span><span style="color:#dcdcdc;">val_;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">SumupTask(</span><span style="color:#569cd6;">final int </span><span style="color:#dcdcdc;">val) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">this.val_ = val;
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">Long call() </span><span style="color:#569cd6;">throws </span><span style="color:#dcdcdc;">Exception {
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">long</span><span style="color:#dcdcdc;"> result = </span><span style="color:#b5cea8;">0</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">for </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">int</span><span style="color:#dcdcdc;"> i = </span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">; i &lt;= val_; i</span><span style="color:#569cd6;">++</span><span style="color:#dcdcdc;">) {
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">result = result + i;
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">return </span><span style="color:#dcdcdc;">Long.valueOf(result);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public static void </span><span style="color:#dcdcdc;">main(String </span><span style="color:#569cd6;">[] </span><span style="color:#dcdcdc;">_args) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">ExecutorService executor = Executors.newCachedThreadPool();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Future&lt;Long&gt; result = executor.submit(</span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">SumupTask(</span><span style="color:#b5cea8;">10000</span><span style="color:#dcdcdc;">));
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread started!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Long longResult = result.get();
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Result is &quot; </span><span style="color:#dcdcdc;">+ longResult);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(ExecutionException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread finished!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">executor.shutdown();
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre><h1 id="futuretask"><a class="zola-anchor" href="#futuretask" aria-label="Anchor link for: futuretask">ğŸ”—</a>
FutureTask</h1>
<p>ç„¶è€Œï¼Œæ—¢ç„¶å·²ç»è®¾è®¡äº†<code>Callable</code>æ¥å£å’Œ<code>Future</code>æ¥å£ï¼Œå´ä¸èƒ½ç›´æ¥ä¸<code>Thread</code>ç±»ä¸€èµ·ä½¿ç”¨ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¿ƒé‡Œä¸æ˜¯æ»‹å‘³ã€‚æ‰€ä»¥æœ‰äººè®¾è®¡äº†ä¸€ä¸ª<code>FutureTask</code>ç±»ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public class </span><span style="color:#dcdcdc;">FutureTask&lt;V&gt; </span><span style="color:#569cd6;">implements </span><span style="color:#4ec9b0;">RunnableFuture</span><span style="color:#dcdcdc;">&lt;V&gt; {}
</span><span style="color:#dcdcdc;">
</span><span style="color:#569cd6;">public interface </span><span style="color:#dcdcdc;">RunnableFuture&lt;V&gt; </span><span style="color:#569cd6;">extends </span><span style="color:#4ec9b0;">Runnable</span><span style="color:#dcdcdc;">, Future&lt;V&gt; {}
</span></pre>
<p>å› ä¸º<code>FutureTask</code>å®ç°äº†<code>Runnable</code>æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä¸<code>Thread</code>ç±»é…åˆä½¿ç”¨ï¼›åˆå› ä¸º<code>FutureTask</code>å®ç°äº†<code>Future</code>æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥æ§åˆ¶ä»»åŠ¡çš„çŠ¶æ€ä»¥åŠè·å–ä»»åŠ¡æ‰§è¡Œç»“æœã€‚</p>
<p><code>FutureTask</code>ç±»æœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼š</p>
<ul>
<li>public FutureTask(Callable<V> callable)</li>
<li>public FutureTask(Runnable runnable, V result)</li>
</ul>
<p>å¯ä»¥é€šè¿‡å®ä¾‹æ¥çœ‹ä¸€ä¸‹<code>FutureTask</code>ç±»å®é™…ä½¿ç”¨ã€‚</p>
<h2 id="futuretask-by-callable"><a class="zola-anchor" href="#futuretask-by-callable" aria-label="Anchor link for: futuretask-by-callable">ğŸ”—</a>
FutureTask by Callable</h2>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public class </span><span style="color:#dcdcdc;">FutureTaskCase {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">CallableMax </span><span style="color:#569cd6;">implements </span><span style="color:#4ec9b0;">Callable</span><span style="color:#dcdcdc;">&lt;Integer&gt; {
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">private final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list_;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">CallableMax(</span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">this.list_ = list;
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">Integer call() </span><span style="color:#569cd6;">throws </span><span style="color:#dcdcdc;">Exception {
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">null </span><span style="color:#dcdcdc;">!= list_ </span><span style="color:#569cd6;">&amp;&amp; !</span><span style="color:#dcdcdc;">list_.isEmpty()) {
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">int</span><span style="color:#dcdcdc;"> result = list_.get(</span><span style="color:#b5cea8;">0</span><span style="color:#dcdcdc;">).intValue();
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">for </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Integer val</span><span style="color:#569cd6;">:</span><span style="color:#dcdcdc;"> list_) {
</span><span style="color:#dcdcdc;">                    </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(result &lt; val.intValue()) {
</span><span style="color:#dcdcdc;">                        </span><span style="color:#dcdcdc;">result = val.intValue();
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">                    </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                        </span><span style="color:#dcdcdc;">Thread.sleep(</span><span style="color:#b5cea8;">100</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">                        </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">return </span><span style="color:#dcdcdc;">Integer.valueOf(result);
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">else </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">return null</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public static void </span><span style="color:#dcdcdc;">main(String </span><span style="color:#569cd6;">[] </span><span style="color:#dcdcdc;">_args) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list = ImmutableList.of(
</span><span style="color:#dcdcdc;">            </span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">199</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">6</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">3</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">56</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">299</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">199</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">28</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">10</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">234
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">FutureTask&lt;Integer&gt; task1 = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">FutureTask(</span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">CallableMax(list));
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Thread task1Thread = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">Thread(task1);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">task1Thread.start();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread started!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Integer re1 = task1.get();
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Result is &quot; </span><span style="color:#dcdcdc;">+ re1);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(ExecutionException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread finished!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>ä½¿ç”¨<code>Callable</code>å®ä¾‹å»æ„é€ <code>FutureTask</code>ç±»å®ä¾‹æ—¶ï¼Œå› ä¸ºç»“æœæ˜¯<code>call()</code>æ–¹æ³•ç›´æ¥è¿”å›çš„ï¼Œæ‰€ä»¥ç”¨æ³•æ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯ä½¿ç”¨<code>Runnable</code>å®ä¾‹å»æ„é€ <code>FutureTask</code>å®ä¾‹æ—¶ï¼Œå› ä¸º<code>run()</code>æ–¹æ³•ä¸èƒ½è¿”å›ç»“æœï¼Œæ‰€ä»¥è¦æä¾›ä¸€ä¸ªå…±äº«å˜é‡ç”¨æ¥ä½œä¸ºå®¹å™¨æ¥å—<code>run()</code>æ–¹æ³•å¤„ç†çš„ç»“æœï¼ŒåŒæ—¶ä¼ é€’ç»“æœç»™è°ƒç”¨çº¿ç¨‹ã€‚æ³¨æ„ï¼Œä½¿ç”¨<code>Runnable</code>æ–¹å¼æ—¶ï¼Œå…±äº«çš„å˜é‡éœ€è¦æ˜¯ä¸€ä¸ªå¯å˜çš„å¯¹è±¡ï¼Œä¸å¯éå¯¹è±¡ç±»å¦‚<code>String</code>ã€<code>Integer</code>ç­‰éœ€è¦æä¾›ä¸€ä¸ªåŒ…è£…ç±»ã€‚</p>
<h2 id="futuretask-by-runnable"><a class="zola-anchor" href="#futuretask-by-runnable" aria-label="Anchor link for: futuretask-by-runnable">ğŸ”—</a>
FutureTask by Runnable</h2>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public class </span><span style="color:#dcdcdc;">FutureTaskCase {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">ValueHolder {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">Integer value;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">private static class </span><span style="color:#dcdcdc;">RunnableMax </span><span style="color:#569cd6;">implements </span><span style="color:#4ec9b0;">Runnable </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">private final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list_;
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">private final </span><span style="color:#dcdcdc;">ValueHolder holder;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">RunnableMax(
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list, </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">ValueHolder valueHolder
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">this.list_ = list;
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">this.holder = valueHolder;
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">public void </span><span style="color:#dcdcdc;">run() {
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">null </span><span style="color:#dcdcdc;">== holder) </span><span style="color:#569cd6;">return </span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">null </span><span style="color:#dcdcdc;">!= list_ </span><span style="color:#569cd6;">&amp;&amp; !</span><span style="color:#dcdcdc;">list_.isEmpty()) {
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">int</span><span style="color:#dcdcdc;"> result = list_.get(</span><span style="color:#b5cea8;">0</span><span style="color:#dcdcdc;">).intValue();
</span><span style="color:#dcdcdc;">                </span><span style="color:#569cd6;">for </span><span style="color:#dcdcdc;">(</span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Integer val </span><span style="color:#569cd6;">:</span><span style="color:#dcdcdc;"> list_) {
</span><span style="color:#dcdcdc;">                    </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(result &lt; val.intValue()) {
</span><span style="color:#dcdcdc;">                        </span><span style="color:#dcdcdc;">result = val.intValue();
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">                    </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                        </span><span style="color:#dcdcdc;">Thread.sleep(</span><span style="color:#b5cea8;">100</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">                        </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">                    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">holder.value = Integer.valueOf(result);
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">else </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">                </span><span style="color:#dcdcdc;">holder.value = </span><span style="color:#569cd6;">null</span><span style="color:#dcdcdc;">;
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public static void </span><span style="color:#dcdcdc;">main(String </span><span style="color:#569cd6;">[] </span><span style="color:#dcdcdc;">_args) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">List&lt;Integer&gt; list = ImmutableList.of(
</span><span style="color:#dcdcdc;">            </span><span style="color:#b5cea8;">1</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">199</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">6</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">3</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">56</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">299</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">199</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">28</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">10</span><span style="color:#dcdcdc;">, </span><span style="color:#b5cea8;">234
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">ValueHolder holder = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">ValueHolder();
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">FutureTask&lt;ValueHolder&gt; task2 = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">FutureTask(
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">RunnableMax(list, holder),
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">holder
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Thread task2Thread = </span><span style="color:#569cd6;">new </span><span style="color:#dcdcdc;">Thread(task2);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">task2Thread.start();
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread started!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">try </span><span style="color:#dcdcdc;">{
</span><span style="color:#dcdcdc;">            </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">ValueHolder re2 = task2.get();
</span><span style="color:#dcdcdc;">            </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Result is &quot; </span><span style="color:#dcdcdc;">+ re2.value);
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(InterruptedException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">} </span><span style="color:#569cd6;">catch </span><span style="color:#dcdcdc;">(ExecutionException e) {
</span><span style="color:#dcdcdc;">            </span><span style="color:#608b4e;">// do nothing
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">System.out.println(</span><span style="color:#d69d85;">&quot;Main thread finished!&quot;</span><span style="color:#dcdcdc;">);
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>ä»£ç ä¸­ä½¿ç”¨äº†<code>ValueHolder</code>æ¥ä¿å­˜<code>run()</code>è®¡ç®—çš„ç»“æœå¹¶ä¼ é€’ç»™<code>Future.get()</code>è¿”å›è°ƒç”¨çº¿ç¨‹ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™ç§æ–¹å¼å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>FutureTask</code>çš„å¯¹åº”ä»£ç ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">FutureTask(Runnable runnable, V result) {
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">this.callable = Executors.callable(runnable, result);
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">this.state = </span><span style="color:#b4cea8;">NEW</span><span style="color:#dcdcdc;">;       </span><span style="color:#608b4e;">// ensure visibility of callable
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>è¯¥æ„é€ å™¨è°ƒç”¨äº†<code>Executors.callable()</code>æ–¹æ³•ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">public static </span><span style="color:#dcdcdc;">&lt;T&gt; Callable&lt;T&gt; callable(Runnable task, T result) {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">if </span><span style="color:#dcdcdc;">(task == </span><span style="color:#569cd6;">null</span><span style="color:#dcdcdc;">)
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">throw new </span><span style="color:#dcdcdc;">NullPointerException();
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">return new </span><span style="color:#dcdcdc;">RunnableAdapter&lt;T&gt;(task, result);
</span><span style="color:#dcdcdc;">}
</span></pre>
<p><code>Executors.callable()</code>æ–¹æ³•ç”¨ä¸€ä¸ª<code>RunnableAdapter</code>ç±»å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†åŒ…è£…ã€‚</p>
<pre style="background-color:#1e1e1e;">
<span style="color:#569cd6;">static final class </span><span style="color:#dcdcdc;">RunnableAdapter&lt;T&gt; </span><span style="color:#569cd6;">implements </span><span style="color:#4ec9b0;">Callable</span><span style="color:#dcdcdc;">&lt;T&gt; {
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">Runnable task;
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">final </span><span style="color:#dcdcdc;">T result;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">RunnableAdapter(Runnable task, T result) {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">this.task = task;
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">this.result = result;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">    </span><span style="color:#569cd6;">public </span><span style="color:#dcdcdc;">T call() {
</span><span style="color:#dcdcdc;">        </span><span style="color:#dcdcdc;">task.run();
</span><span style="color:#dcdcdc;">        </span><span style="color:#569cd6;">return</span><span style="color:#dcdcdc;"> result;
</span><span style="color:#dcdcdc;">    </span><span style="color:#dcdcdc;">}
</span><span style="color:#dcdcdc;">}
</span></pre>
<p>åœ¨åŒ…è£…ç±»<code>RunnableAdapter</code>å†…éƒ¨ç®€å•åœ°ä¿å­˜äº†<code>Runnable</code>å®ä¾‹å’Œç›®æ ‡ç±»å‹å¯¹è±¡ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œ<code>T</code>ç±»å‹çš„å¯¹è±¡è´Ÿè´£è®°å½•ä»»åŠ¡ç»“æœï¼Œè€Œ<code>Runnable</code>å®ä¾‹çš„<code>run()</code>æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿®æ”¹è¯¥å¯¹è±¡çš„å€¼ã€‚å¦‚æœ<code>T</code>æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ï¼Œåˆ™<code>run()</code>æ–¹æ³•ä¸­çš„ä¿®æ”¹ä¼ é€’ä¸åˆ°å¤–éƒ¨æ¥ã€‚</p>
<p>æ—¢ç„¶è¿™ä¹ˆå¤æ‚ï¼Œé‚£ä¹ˆè¿˜æ˜¯å°½é‡ä½¿ç”¨å¸¦<code>Callable</code>æ„é€ å™¨çš„ç‰ˆæœ¬å§ï¼</p>
<h1 id="dai-ma-xia-zai"><a class="zola-anchor" href="#dai-ma-xia-zai" aria-label="Anchor link for: dai-ma-xia-zai">ğŸ”—</a>
ä»£ç ä¸‹è½½</h1>
<p><a href="https://www.wangbo.im/posts/2016-04-13-learning-java-concurrency-futuretask-callable/CallableFutureCase.java">CallableFutureCase.java</a>
<a href="https://www.wangbo.im/posts/2016-04-13-learning-java-concurrency-futuretask-callable/FutureTaskCase.java">FutureTaskCase.java</a></p>

        </div>
        
    
</div></div>
            
    <div class="pagination">
        <div class="pagination__buttons">
            </div>
    </div>
<footer class="footer">
                    <div class="footer__inner"><div class="copyright copyright--user"><span>Â© 2019 <a href="https://www.wangbo.im">wangbo&apos; blog</a> :: <a href="https://github.wangbo.im">Github</a> :: Powered by <a href="https://www.getzola.org/">Zola</a></span></div>
    <script type="text/javascript" src="https:&#x2F;&#x2F;www.wangbo.im&#x2F;assets&#x2F;js&#x2F;main.js"></script>
</div>
                    

                </footer></div>
    </body>
</html>
