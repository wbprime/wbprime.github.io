<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            Spring MVC Integration Testing - Controllers | 
        
        wbprime
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Elvis Wang">
    <meta name="description" content="Why bloging ?">
    <meta name="keywords" content="wbprime,Java,Spring MVC,Test">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="wbprime">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://www.wbprime.me">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Spring MVC Integration Testing - Controllers | wbprime">
    <meta property="og:description" content="Why bloging ?">
    <meta property="og:article:tag" content="Java"> <meta property="og:article:tag" content="Spring MVC"> <meta property="og:article:tag" content="Test"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#通过Maven获取依赖"><span class="post-toc-number">1.</span> <span class="post-toc-text">通过Maven获取依赖</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Spring-Test-DBUnit-快速入门"><span class="post-toc-number">2.</span> <span class="post-toc-text">Spring Test DBUnit 快速入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建Spring上下文配置"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">创建Spring上下文配置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置测试用例类"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">配置测试用例类</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Spring-MVC-Test-快速入门"><span class="post-toc-number">3.</span> <span class="post-toc-text">Spring MVC Test 快速入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#创建并执行请求"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">创建并执行请求</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#验证请求返回结果"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">验证请求返回结果</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#示例web应用结构"><span class="post-toc-number">4.</span> <span class="post-toc-text">示例web应用结构</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Domain-层"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">Domain 层</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Service-层"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Service 层</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Controller-层"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">Controller 层</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#测试用例"><span class="post-toc-number">5.</span> <span class="post-toc-text">测试用例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#创建测试用例类框架"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">创建测试用例类框架</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#编写集成测试用例"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">编写集成测试用例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#获取Todo项列表接口的测试用例"><span class="post-toc-number">5.2.1.</span> <span class="post-toc-text">获取Todo项列表接口的测试用例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#获取单个Todo项详情接口的测试用例"><span class="post-toc-number">5.2.2.</span> <span class="post-toc-text">获取单个Todo项详情接口的测试用例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#删除指定Todo项接口的测试用例"><span class="post-toc-number">5.2.3.</span> <span class="post-toc-text">删除指定Todo项接口的测试用例</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#总结"><span class="post-toc-number">6.</span> <span class="post-toc-text">总结</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                Spring MVC Integration Testing - Controllers
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/logo.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Elvis Wang</strong>
        <span>4月 09, 2016</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">在其它设备中阅读本文章</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAADkklEQVR42u3aS27jMBAFwNz/0jPbAJko73WTjjEorQxDFsnSot2fjz+uT9cHAhw4cODAgQMHDhw43pjjI77+8aBP33+98/mbr89sf9ve8+26OHDgwIHjAscPoejxnvaQ+fOfj50//3ktHDhw4MBxj6NdPn9C+wKSIyX7fL4HBw4cOHC8D0cSeqMgl6RYQZKGAwcOHDj+V448YXs+dl6IxIEDBw4c78yRb2VfKMyfn6SFv1YrxYEDBw4c33DkQwDv//ml8x04cODAgeMLx6zlsxlEyANnXo5cnQgHDhw4cBzlaAednzeaN5ZmRb1ZU+qHxA8HDhw4cFzmSBbLw2oeqnOyPGGLzogDBw4cOC5wtCW22W/b9Gy24oEUDgcOHDhwHCoORk2aEU0bvGfFx1lJEQcOHDhwnOXIl7w36LZJCzfcOHDgwIHjBsds088HmA03zEqHm9IkDhw4cOC4xzEbU2ibSc8bvZFSroqDOHDgwIFjzdEeow2i+8GFJADXfwVw4MCBA8dRjk0QLYYGYugN8fCl4sCBAweOyxyzpk4+XnA2POcDFjhw4MCB4/Uc+ebacYT9MNy+OPjtWjhw4MCB4yjHJsQ+p0ltWD3buBoGWhw4cODAseaYjbLNQnIeaDdlxKQ0iQMHDhw4XsPRAs0CZF7IS5hmyR4OHDhw4LjH0S6fbG7WstrcOSsL4sCBAweOexx5AS5ZuE2u8mJf3rJKAj8OHDhw4LjBMTt2PtCQN5lmA3B5kC6Kgzhw4MCBY83RlthauOfg17agNkMSOHDgwIHjNkebmM3KgptRhqS5NWtf4cCBAweO13AkB5iNqc0KiO1z2peEAwcOHDjucZwNqJsRujbEHisO4sCBAweOo32W2TJ5ATF58tmwuqqV4sCBAweOBUe7laSodw83X70uDuLAgQMHjqMcswbSLLnapI75/nHgwIEDxztwzEqHbWNpXxxMfhvtHwcOHDhwHOVor2T5TVht07PkFRbFQRw4cODAseZo2zn5sEK79X2xcpaO4sCBAweOGxxt4W8z0LYPzHnR8MBAAw4cOHDgWHC0x2vbRcnB8qA+ez3DLhwOHDhw4HgJRzu+0IbPfFhhNoSBAwcOHDjejSMvz+WJVn7U2UgEDhw4cOB4JUeyoTzszZK32eFXfwhw4MCBA8cFjjxQFe2cchhuVlhsBx1w4MCBA8dtDhcOHDhw4MCBAwcOHDje7PoLfFmGX8yuE0gAAAAASUVORK5CYII=">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/java/">Java</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/spring-mvc/">Spring MVC</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/test/">Test</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Spring MVC Integration Testing - Controllers&url=http://www.wbprime.me//2016/04/09/spring-mvc-testing-integration-testing-controllers/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Spring MVC Integration Testing - Controllers&url=http://www.wbprime.me//2016/04/09/spring-mvc-testing-integration-testing-controllers/index.html&via=Elvis Wang" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.wbprime.me//2016/04/09/spring-mvc-testing-integration-testing-controllers/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://www.wbprime.me//2016/04/09/spring-mvc-testing-integration-testing-controllers/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>本文是<a href="/2016/04/09/spring-mvc-testing-content/">Spring MVC Testing</a> 集成测试系列的第2篇，原文链接：<a href="http://www.petrikainulainen.net/programming/spring-framework/integration-testing-of-spring-mvc-applications-controllers/" target="_blank" rel="external">Integration Testing of Spring MVC Applications: Controllers</a>。</p>
<p>本文主要介绍如何为“标准”Controller编写集成测试。在这里“标准”的含义延续前一个序列 <a href="/2016/04/09/spring-mvc-testing-content/">Spring MVC Testing</a> 中的含义，表示不使用Ajax的请求或者处理Form结果的请求。</p>
<p>同样地，本文还是一步一步地为我们的TodoApplication编写集成测试。该程序提供Todo项的增删改查（CRUD）接口，本文主要关注其中的3个接口：获取Todo项列表；查看单个Todo项的详情；以及删除某个Todo项。</p>
<a id="more"></a>
<h1 id="通过Maven获取依赖"><a href="#通过Maven获取依赖" class="headerlink" title="通过Maven获取依赖"></a>通过Maven获取依赖</h1><p>本文用到的依赖如下：</p>
<ul>
<li>Hamcrest 1.3</li>
<li>JUnit 4.10</li>
<li>Spring Test 3.2.3.RELEASE</li>
<li>Spring Test DBUnit 1.0.0</li>
<li>DBUnit 2.4.8</li>
</ul>
<p>生成的pom.xml文件的片段如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hamcrest<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hamcrest-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hamcrest-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hamcrest<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.springtestdbunit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test-dbunit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.dbunit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dbunit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>            </div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="Spring-Test-DBUnit-快速入门"><a href="#Spring-Test-DBUnit-快速入门" class="headerlink" title="Spring Test DBUnit 快速入门"></a>Spring Test DBUnit 快速入门</h1><p>我们在集成测试中使用了 <a href="http://springtestdbunit.github.com/spring-test-dbunit/" target="_blank" rel="external">Spring Test DBUnit</a> 库和 <a href="http://www.dbunit.org/" target="_blank" rel="external">DBUnit</a> 库。我们快速地熟悉一下如何使用它们。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="创建Spring上下文配置"><a href="#创建Spring上下文配置" class="headerlink" title="创建Spring上下文配置"></a>创建Spring上下文配置</h3><p>首先需要创建Spring上下文配置，让Spring来管理依赖。</p>
<ol>
<li>创建一个Java类，并用<code>@Configuration</code>注解</li>
<li>新建<code>application.properties</code>属性文件，并使用<code>@PropertySource</code>注解导入类配置上下文中</li>
<li>添加一个<code>Environment</code>类型的成员用于获取属性文件中的配置信息</li>
<li>使用<code>@Bean</code>注解创建一个<code>DataSource</code>类型的Bean</li>
</ol>
<p>最终的结果如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.jolbox.bonecp.BoneCPDataSource;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</div><div class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> javax.annotation.Resource;</div><div class="line"><span class="keyword">import</span> javax.sql.DataSource;</div><div class="line"> </div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:application.properties"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleApplicationContext</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Resource</span></div><div class="line">    <span class="keyword">private</span> Environment environment;</div><div class="line"> </div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span> </span>&#123;</div><div class="line">        BoneCPDataSource dataSource = <span class="keyword">new</span> BoneCPDataSource();</div><div class="line"> </div><div class="line">        dataSource.setDriverClass(environment.getRequiredProperty(<span class="string">"db.driver"</span>));</div><div class="line">        dataSource.setJdbcUrl(environment.getRequiredProperty(<span class="string">"db.url"</span>));</div><div class="line">        dataSource.setUsername(environment.getRequiredProperty(<span class="string">"db.username"</span>));</div><div class="line">        dataSource.setPassword(environment.getRequiredProperty(<span class="string">"db.password"</span>));</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> dataSource;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="配置测试用例类"><a href="#配置测试用例类" class="headerlink" title="配置测试用例类"></a>配置测试用例类</h3><p>我们可以通过如下步骤在测试用例类中使用DBUnit：</p>
<ol>
<li>对测试用例类使用<code>@RunWith(SpringJUnit4ClassRunner.class)</code>注解</li>
<li>对测试用例类使用<code>@ContextConfiguratiON</code>注解并引入上一步创建的<code>ExampleApplicationContext</code>类作为Spring配置上下文</li>
<li>对测试用例类使用<code>@TestExecutionListeners</code>注解并使用<code>DbUnitTestExecutionListener</code>来处理DBUnit的相关注解</li>
</ol>
<p>最终代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> javax.annotation.Resource;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">    <span class="comment">//Add test methods here</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>使用DBUnit，我们可以用注解来初始化数据库、初始化数据表以及在测试结束后验证数据库的状态。详细使用请参见 <a href="http://springtestdbunit.github.com/spring-test-dbunit/" target="_blank" rel="external">Spring Test DBUnit</a>。本文将会使用如下两个注解：</p>
<ul>
<li>@DatabaseSetup 用于在测试开始之前将数据库初始化到指定状态</li>
<li>@ExpectedDatabase 用于在测试结束之后验证数据库状态</li>
</ul>
<h1 id="Spring-MVC-Test-快速入门"><a href="#Spring-MVC-Test-快速入门" class="headerlink" title="Spring MVC Test 快速入门"></a>Spring MVC Test 快速入门</h1><h2 id="创建并执行请求"><a href="#创建并执行请求" class="headerlink" title="创建并执行请求"></a>创建并执行请求</h2><p><code>MockMvc</code>类的<code>perform(RequestBuilder requestBuilder)</code>方法可以用来模拟执行HTTP请求。<code>MockMvcRequestBuilders</code>类提供了几个静态方法用来模拟HTTP请求实体，具体是：</p>
<ul>
<li><code>get()</code> 用于创建一个模拟的HTTP GET请求实体</li>
<li><code>delete()</code> 用于创建一个模拟的HTTP DELETE请求实体</li>
<li><code>fileUpload()</code> 用于创建一个模拟的HTTP文件上传请求实体（multipart request）</li>
<li><code>post()</code> 用于创建一个模拟的HTTP POST请求实体</li>
<li><code>put()</code> 用于创建一个模拟的HTTP PUT请求实体</li>
</ul>
<p>详情可以查看<code>MockHttpServletRequestBuilder</code>类的说明文档。</p>
<h2 id="验证请求返回结果"><a href="#验证请求返回结果" class="headerlink" title="验证请求返回结果"></a>验证请求返回结果</h2><p><code>ResultActions</code>类提供了3个方法来提供对模拟的HTTP请求返回结果的处理：</p>
<ul>
<li><code>void andExpect(ResultMatcher matcher)</code> 用于对返回结果作断言验证</li>
<li><code>void andDo(ResultHandler handler)</code> 用于对返回结果进行二次操作</li>
<li><code>MvcResult andReturn()</code> 用于直接返回结果</li>
</ul>
<p>为了提高代码效率，<code>MockMvcResultMatchers</code>类和<code>MockMvcResultHandlers</code>类提供了许多静态方法：</p>
<ul>
<li><code>MockMvcResultMatchers</code>类提供了很多包装好的<code>Matcher</code>实例</li>
<li><code>MockMvcResultHandlers</code>类目前只提供了<code>print()</code>方法返回一个<code>Handler</code>实例可以输出返回结果到控制台</li>
</ul>
<h1 id="示例web应用结构"><a href="#示例web应用结构" class="headerlink" title="示例web应用结构"></a>示例web应用结构</h1><h2 id="Domain-层"><a href="#Domain-层" class="headerlink" title="Domain 层"></a>Domain 层</h2><p>Domain层提供了<code>Todo</code>实体类，表示一个一个的Todo项。</p>
<p><code>Todo</code>类代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.hibernate.annotations.Type;</div><div class="line"><span class="keyword">import</span> org.joda.time.DateTime;</div><div class="line"><span class="keyword">import</span> javax.persistence.*;</div><div class="line"> </div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name=<span class="string">"todos"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Id</span></div><div class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.AUTO)</div><div class="line">    <span class="keyword">private</span> Long id;</div><div class="line"> </div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"creation_time"</span>, nullable = <span class="keyword">false</span>)</div><div class="line">    <span class="meta">@Type</span>(type=<span class="string">"org.jadira.usertype.dateandtime.joda.PersistentDateTime"</span>)</div><div class="line">    <span class="keyword">private</span> DateTime creationTime;</div><div class="line"> </div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"description"</span>, nullable = <span class="keyword">true</span>, length = <span class="number">500</span>)</div><div class="line">    <span class="keyword">private</span> String description;</div><div class="line"> </div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"modification_time"</span>, nullable = <span class="keyword">false</span>)</div><div class="line">    <span class="meta">@Type</span>(type=<span class="string">"org.jadira.usertype.dateandtime.joda.PersistentDateTime"</span>)</div><div class="line">    <span class="keyword">private</span> DateTime modificationTime;</div><div class="line"> </div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"title"</span>, nullable = <span class="keyword">false</span>, length = <span class="number">100</span>)</div><div class="line">    <span class="keyword">private</span> String title;</div><div class="line"> </div><div class="line">    <span class="meta">@Version</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">long</span> version;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Todo</span><span class="params">()</span> </span>&#123;</div><div class="line"> </div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="comment">//Getters and other methods</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Service-层"><a href="#Service-层" class="headerlink" title="Service 层"></a>Service 层</h2><p>Service层提供了<code>TodoService</code>接口，用来连接Controller层和Domain层的通信。该接口提供了3个方法：</p>
<ul>
<li><code>Todo deleteById(Long id)</code> 删除指定id的Todo项；如果不存在该Todo项，则抛出<code>TodoNotFoundException</code>异常</li>
<li><code>List&lt;Todo&gt; findAll()</code> 返回所有Todo项的列表；如果没有Todo项，则返回空列表</li>
<li><code>Todo findById(Long id)</code> 返回指定id的Todo项；如果不存在该Todo项，则抛出<code>TodoNotFoundException</code>异常</li>
</ul>
<p><code>TodoService</code>接口代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TodoService</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> Todo <span class="title">deleteById</span><span class="params">(Long id)</span> <span class="keyword">throws</span> TodoNotFoundException</span>;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Todo&gt; <span class="title">findAll</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> Todo <span class="title">findById</span><span class="params">(Long id)</span> <span class="keyword">throws</span> TodoNotFoundException</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Controller-层"><a href="#Controller-层" class="headerlink" title="Controller 层"></a>Controller 层</h2><p>Controller层提供了<code>TodoController</code>类，用于创建视图、处理请求。</p>
<p><code>TodoController</code>类代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.context.MessageSource;</div><div class="line"><span class="keyword">import</span> org.springframework.context.i18n.LocaleContextHolder;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</div><div class="line"><span class="keyword">import</span> org.springframework.ui.Model;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.support.RedirectAttributes;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> javax.annotation.Resource;</div><div class="line"><span class="keyword">import</span> javax.validation.Valid;</div><div class="line"> </div><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoController</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Resource</span></div><div class="line">    <span class="keyword">private</span> TodoService service;</div><div class="line"> </div><div class="line">    <span class="meta">@Resource</span></div><div class="line">    <span class="keyword">private</span> MessageSource messageSource;</div><div class="line"> </div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/todo/delete/&#123;id&#125;"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id, RedirectAttributes attributes) <span class="keyword">throws</span> TodoNotFoundException </span>&#123;</div><div class="line">        Todo deleted = service.deleteById(id);</div><div class="line"> </div><div class="line">        addFeedbackMessage(attributes, <span class="string">"feedback.message.todo.deleted"</span>, deleted.getTitle());</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> createRedirectViewPath(<span class="string">"/"</span>);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findAll</span><span class="params">(Model model)</span> </span>&#123;</div><div class="line">        List&lt;Todo&gt; models = service.findAll();</div><div class="line"> </div><div class="line">        model.addAttribute(<span class="string">"todos"</span>, models);</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> <span class="string">"todo/list"</span>;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/todo/&#123;id&#125;"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id, Model model) <span class="keyword">throws</span> TodoNotFoundException </span>&#123;</div><div class="line">        Todo found = service.findById(id);</div><div class="line"> </div><div class="line">        model.addAttribute(<span class="string">"todo"</span>, found);</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> <span class="string">"todo/view"</span>;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addFeedbackMessage</span><span class="params">(RedirectAttributes attributes, String messageCode, Object... messageParameters)</span> </span>&#123;</div><div class="line">        String localizedFeedbackMessage = getMessage(messageCode, messageParameters);</div><div class="line">        attributes.addFlashAttribute(<span class="string">"feedbackMessage"</span>, localizedFeedbackMessage);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getMessage</span><span class="params">(String messageCode, Object... messageParameters)</span> </span>&#123;</div><div class="line">        Locale current = LocaleContextHolder.getLocale();</div><div class="line">        <span class="keyword">return</span> messageSource.getMessage(messageCode, messageParameters, current);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">createRedirectViewPath</span><span class="params">(String requestMapping)</span> </span>&#123;</div><div class="line">        StringBuilder redirectViewPath = <span class="keyword">new</span> StringBuilder();</div><div class="line">        redirectViewPath.append(<span class="string">"redirect:"</span>);</div><div class="line">        redirectViewPath.append(requestMapping);</div><div class="line">        <span class="keyword">return</span> redirectViewPath.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h1><h2 id="创建测试用例类框架"><a href="#创建测试用例类框架" class="headerlink" title="创建测试用例类框架"></a>创建测试用例类框架</h2><p>要搭建起测试框架，需要以下步骤：</p>
<ol>
<li>搭建Spring MVC Test环境</li>
<li>搭建DbUnit环境</li>
<li>配置DBUnit，设定测试开始和结束时的状态</li>
</ol>
<p>没有添加任何测试方法前的框架代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> org.junit.Before;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.setup.MockMvcBuilders;</div><div class="line"><span class="keyword">import</span> org.springframework.web.context.WebApplicationContext;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> javax.annotation.Resource;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Resource</span></div><div class="line">    <span class="keyword">private</span> WebApplicationContext webApplicationContext;</div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</div><div class="line">        mockMvc = MockMvcBuilders.webApplicationContextSetup(webApplicationContext)</div><div class="line">                .build();</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">    <span class="comment">//Add tests here</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意代码中的<code>@DatabaseSetup(&quot;toDoData.xml&quot;)</code>注解，该注解的作用在于使用<code>todoData.xml</code>文件中的数据去初始化数据库表，该注解由<code>DbUnitTestExecutionListener</code>进行解析。</p>
<p><code>todoData.xml</code>文件内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dataset</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">todos</span> <span class="attr">id</span>=<span class="string">"1"</span> <span class="attr">creation_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">description</span>=<span class="string">"Lorem ipsum"</span> <span class="attr">modification_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">title</span>=<span class="string">"Foo"</span> <span class="attr">version</span>=<span class="string">"0"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">todos</span> <span class="attr">id</span>=<span class="string">"2"</span> <span class="attr">creation_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">description</span>=<span class="string">"Lorem ipsum"</span> <span class="attr">modification_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">title</span>=<span class="string">"Bar"</span> <span class="attr">version</span>=<span class="string">"0"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dataset</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="编写集成测试用例"><a href="#编写集成测试用例" class="headerlink" title="编写集成测试用例"></a>编写集成测试用例</h2><h3 id="获取Todo项列表接口的测试用例"><a href="#获取Todo项列表接口的测试用例" class="headerlink" title="获取Todo项列表接口的测试用例"></a>获取Todo项列表接口的测试用例</h3><p>编写该测试用例的思路如下：</p>
<ol>
<li>使用<code>@ExpectedDatabase</code>注解来验证接口没有对数据库表状态产生变化</li>
<li>模拟执行”/“的GET请求，并取得返回的响应结果</li>
<li>对返回的响应结果作断言：HTTP状态码为200</li>
<li>对返回的响应结果作断言：view的名字是’todo/list’</li>
<li>对返回的响应结果作断言：view的路径为”/WEB-INF/jsp/todo/list.jsp”</li>
<li>对返回的响应结果作断言：model中Todo项的个数是2</li>
<li>对返回的响应结果作断言：model中的Todo项符合预期</li>
</ol>
<p>最终的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.ExpectedDatabase;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.Matchers.*;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.request.MockMvcRequestBuilders.get;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.result.MockMvcResultMatchers.*;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">//Add web application context here</span></div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="comment">//Add setUp() method here</span></div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="meta">@ExpectedDatabase</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mockMvc.perform(get(<span class="string">"/"</span>))</div><div class="line">                .andExpect(status().isOk())</div><div class="line">                .andExpect(view().name(<span class="string">"todo/list"</span>))</div><div class="line">                .andExpect(forwardedUrl(<span class="string">"/WEB-INF/jsp/todo/list.jsp"</span>))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todos"</span>, hasSize(<span class="number">2</span>)))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todos"</span>, hasItem(</div><div class="line">                        allOf(</div><div class="line">                                hasProperty(<span class="string">"id"</span>, is(<span class="number">1L</span>)),</div><div class="line">                                hasProperty(<span class="string">"description"</span>, is(<span class="string">"Lorem ipsum"</span>)),</div><div class="line">                                hasProperty(<span class="string">"title"</span>, is(<span class="string">"Foo"</span>))</div><div class="line">                        )</div><div class="line">                )))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todos"</span>, hasItem(</div><div class="line">                        allOf(</div><div class="line">                                hasProperty(<span class="string">"id"</span>, is(<span class="number">2L</span>)),</div><div class="line">                                hasProperty(<span class="string">"description"</span>, is(<span class="string">"Lorem ipsum"</span>)),</div><div class="line">                                hasProperty(<span class="string">"title"</span>, is(<span class="string">"Bar"</span>))</div><div class="line">                        )</div><div class="line">                )));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="获取单个Todo项详情接口的测试用例"><a href="#获取单个Todo项详情接口的测试用例" class="headerlink" title="获取单个Todo项详情接口的测试用例"></a>获取单个Todo项详情接口的测试用例</h3><p>根据参数的不同，获取单个Todo项详情接口会有两种不同的返回结果：</p>
<ul>
<li>如果指定id的Todo项存在，返回单个Todo项的详情页</li>
<li>如果指定id的Todo项不存在，返回404页</li>
</ul>
<p>对于指定Todo项存在的情况，我们可以按照以下步骤来编写测试用例：</p>
<ol>
<li>使用<code>@ExpectedDatabase</code>注解来验证接口没有对数据库表状态产生变化</li>
<li>模拟执行”/todo/1”的GET请求，并取得返回的响应结果</li>
<li>对返回的响应结果作断言：HTTP状态码为200</li>
<li>对返回的响应结果作断言：view的名字是’todo/view’</li>
<li>对返回的响应结果作断言：view的路径为”/WEB-INF/jsp/todo/view.jsp”</li>
<li>对返回的响应结果作断言：model中的Todo项符合预期</li>
</ol>
<p>最终的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.ExpectedDatabase;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.Matchers.*;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.request.MockMvcRequestBuilders.get;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.result.MockMvcResultMatchers.*;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">//Add web application context here</span></div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="comment">//Add setUp() method here</span></div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="meta">@ExpectedDatabase</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mockMvc.perform(get(<span class="string">"/todo/&#123;id&#125;"</span>, <span class="number">1L</span>))</div><div class="line">                .andExpect(status().isOk())</div><div class="line">                .andExpect(view().name(<span class="string">"todo/view"</span>))</div><div class="line">                .andExpect(forwardedUrl(<span class="string">"/WEB-INF/jsp/todo/view.jsp"</span>))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todo"</span>, hasProperty(<span class="string">"id"</span>, is(<span class="number">1L</span>))))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todo"</span>, hasProperty(<span class="string">"description"</span>, is(<span class="string">"Lorem ipsum"</span>))))</div><div class="line">                .andExpect(model().attribute(<span class="string">"todo"</span>, hasProperty(<span class="string">"title"</span>, is(<span class="string">"Foo"</span>))));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于指定Todo项不存在的情况，我们可以按照以下步骤来编写测试用例：</p>
<ol>
<li>使用<code>@ExpectedDatabase</code>注解来验证接口没有对数据库表状态产生变化</li>
<li>模拟执行”/todo/3”的GET请求，并取得返回的响应结果</li>
<li>对返回的响应结果作断言：HTTP状态码为404</li>
<li>对返回的响应结果作断言：view的名字是’error/404’</li>
<li>对返回的响应结果作断言：view的路径为”/WEB-INF/jsp/error/404.jsp”</li>
</ol>
<p>最终的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.ExpectedDatabase;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.request.MockMvcRequestBuilders.get;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.result.MockMvcResultMatchers.*;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">//Add web application context here</span></div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="comment">//Add setUp() method here</span></div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="meta">@ExpectedDatabase</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByIdWhenTodoIsNotFound</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mockMvc.perform(get(<span class="string">"/todo/&#123;id&#125;"</span>, <span class="number">3L</span>))</div><div class="line">                .andExpect(status().isNotFound())</div><div class="line">                .andExpect(view().name(<span class="string">"error/404"</span>))</div><div class="line">                .andExpect(forwardedUrl(<span class="string">"/WEB-INF/jsp/error/404.jsp"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="删除指定Todo项接口的测试用例"><a href="#删除指定Todo项接口的测试用例" class="headerlink" title="删除指定Todo项接口的测试用例"></a>删除指定Todo项接口的测试用例</h3><p>根据参数的不同，删除指定Todo项接口会有两种不同的返回结果：</p>
<ul>
<li>如果指定id的Todo项存在，数据库中的Todo会被删除</li>
<li>如果指定id的Todo项不存在，返回404页</li>
</ul>
<p>对于指定Todo项存在的情况，我们可以按照以下步骤来编写测试用例：</p>
<ol>
<li>使用<code>@ExpectedDatabase</code>注解来验证接口对数据库的操作符合预期</li>
<li>模拟执行”/todo/delete/1”的GET请求，并取得返回的响应结果</li>
<li>对返回的响应结果作断言：HTTP状态码为200</li>
<li>对返回的响应结果作断言：view的名字是’redirect:/‘</li>
<li>对返回的响应结果作断言：view的路径为”/WEB-INF/jsp/todo/view.jsp”</li>
<li>对返回的响应结果作断言：flash中返回了预期的提示信息</li>
</ol>
<p>最终的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.ExpectedDatabase;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.Matchers.is;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.request.MockMvcRequestBuilders.get;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.result.MockMvcResultMatchers.*;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">//Add web application context here</span></div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="comment">//Add setUp() method here</span></div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="meta">@ExpectedDatabase</span>(<span class="string">"todoData-delete-expected.xml"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mockMvc.perform(get(<span class="string">"/todo/delete/&#123;id&#125;"</span>, <span class="number">1L</span>))</div><div class="line">                .andExpect(status().isOk())</div><div class="line">                .andExpect(view().name(<span class="string">"redirect:/"</span>))</div><div class="line">                .andExpect(flash().attribute(<span class="string">"feedbackMessage"</span>, is(<span class="string">"Todo entry: Foo was deleted."</span>)));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>作为对照，<code>todoData-delete-expected.xml</code>文件包含了预期的数据库表结果，内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dataset</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">todos</span> <span class="attr">id</span>=<span class="string">"2"</span> <span class="attr">creation_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">description</span>=<span class="string">"Lorem ipsum"</span> <span class="attr">modification_time</span>=<span class="string">"2012-10-21 11:13:28"</span> <span class="attr">title</span>=<span class="string">"Bar"</span> <span class="attr">version</span>=<span class="string">"0"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dataset</span>&gt;</span></div></pre></td></tr></table></figure>
<p>对于指定Todo项不存在的情况，我们可以按照以下步骤来编写测试用例：</p>
<ol>
<li>使用<code>@ExpectedDatabase</code>注解来验证接口没有对数据库表状态产生变化</li>
<li>模拟执行”/todo/delete/3”的GET请求，并取得返回的响应结果</li>
<li>对返回的响应结果作断言：HTTP状态码为404</li>
<li>对返回的响应结果作断言：view的名字是’error/404’</li>
<li>对返回的响应结果作断言：view的路径为”/WEB-INF/jsp/error/404.jsp”</li>
</ol>
<p>最终的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.DbUnitTestExecutionListener;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.DatabaseSetup;</div><div class="line"><span class="keyword">import</span> com.github.springtestdbunit.annotation.ExpectedDatabase;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.TestExecutionListeners;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DependencyInjectionTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.support.DirtiesContextTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.context.transaction.TransactionalTestExecutionListener;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.MockMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.test.web.server.samples.context.WebContextLoader;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.request.MockMvcRequestBuilders.get;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.server.result.MockMvcResultMatchers.*;</div><div class="line"> </div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(loader = WebContextLoader.class, classes = &#123;ExampleApplicationContext.class&#125;)</div><div class="line"><span class="meta">@TestExecutionListeners</span>(&#123; DependencyInjectionTestExecutionListener.class,</div><div class="line">        DirtiesContextTestExecutionListener.class,</div><div class="line">        TransactionalTestExecutionListener.class,</div><div class="line">        DbUnitTestExecutionListener.class &#125;)</div><div class="line"><span class="meta">@DatabaseSetup</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITTodoControllerTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">//Add web application context here</span></div><div class="line"> </div><div class="line">    <span class="keyword">private</span> MockMvc mockMvc;</div><div class="line"> </div><div class="line">    <span class="comment">//Add setUp() method here</span></div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="meta">@ExpectedDatabase</span>(<span class="string">"toDoData.xml"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteByIdWhenTodoIsNotFound</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mockMvc.perform(get(<span class="string">"/todo/delete/&#123;id&#125;"</span>, <span class="number">3L</span>))</div><div class="line">                .andExpect(status().isNotFound())</div><div class="line">                .andExpect(view().name(<span class="string">"error/404"</span>))</div><div class="line">                .andExpect(forwardedUrl(<span class="string">"/WEB-INF/jsp/error/404.jsp"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>到此为止，我们就写完了所有的测试用例代码。总结一下，本文主要内容如下：</p>
<ul>
<li>如何生成并执行模拟的HTTP请求，以及如何对响应结果作断言</li>
<li>使用Spring MVC Test编写的集成测试用例可读性非常好，可以作为接口文档的补充</li>
<li>Spring MVC Test没法验证view是否正确绘制，但可以验证是否使用了预期的view模板</li>
</ul>
<p>下一篇是 <a href="/2016/04/09/spring-mvc-testing-integration-testing-forms/">Spring MVC Integration Testing - Forms</a>。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    




                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2016/04/09/spring-mvc-testing-integration-testing-forms/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/04/09/spring-mvc-testing-integration-testing-configuration/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/logo.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/logo.png" alt="Elvis Wang's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        mail@wbprime.me
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">17</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/06/">六月 2015<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/05/">五月 2015<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/05/">五月 2014<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2013/05/">五月 2013<span class="sidebar_archives-count">18</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/c-c/">C/C++<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/learning-java-concurrency/">Learning Java Concurrency<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/life/">Life<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/mayday/">Mayday<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/categories/spring-di/">Spring DI<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/spring-mvc-testing/">Spring MVC Testing<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/categories/tech/">Tech<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">59</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/wbprime" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;wbprime
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
